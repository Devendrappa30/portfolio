<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Project Management Reports</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prop-types/15.8.1/prop-types.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.2/babel.min.js"></script>
  <script src="https://unpkg.com/papaparse@latest/papaparse.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chrono-node/1.3.11/chrono.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/recharts/2.15.0/Recharts.min.js"></script>
</head>
<body class="bg-gray-200 font-sans">
  <div class="top-nav-buttons" style="display: flex; gap: 10px; justify-content: flex-start; margin-bottom: 16px; margin-top: 16px;">
  <!-- Return Home Button (icon only) -->
  <a href="../../index.html" class="icon-btn" title="Return Home" aria-label="Return Home"
    style="background: #2563EB; color: #fff; border: none; border-radius: 50%; width: 42px; height: 42px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: background 0.2s; font-size: 1.3em; box-shadow: 0 2px 6px rgba(30,58,138,0.08);">
    <!-- Home SVG -->
    <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="24" height="24">
      <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l9-9 9 9M9 21h6a2 2 0 002-2v-7h-2v7H9v-7H7v7a2 2 0 002 2z"/>
    </svg>
  </a>
  <!-- Return Button (icon only) -->
  <button class="icon-btn" onclick="history.back()" title="Return (Back)" aria-label="Return"
    style="background: #2563EB; color: #fff; border: none; border-radius: 50%; width: 42px; height: 42px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: background 0.2s; font-size: 1.3em; box-shadow: 0 2px 6px rgba(30,58,138,0.08);">
    <!-- Arrow Left SVG -->
    <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="24" height="24">
      <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/>
    </svg>
  </button>
</div>
  <div id="root"></div>
  <script type="text/babel">
    // Inline CSV data for Work Estimation
    const workEstimationCsv = `WBS Level,Task Name,Owner,Complexity,Estimated Effort (Person-Days)
1.1,Salesforce Environment Setup,Salesforce Admin,M,10
1.1.1,Development Environment Setup,Salesforce Admin,L,3
1.1.2,Testing Environment Setup,Salesforce Admin,L,3
1.1.3,Production Environment Setup,Salesforce Admin,M,4
1.2,Requirements Documentation,Business Analyst,H,15
1.2.1,Stakeholder Interviews,Business Analyst,L,5
1.2.2,Requirement Workshops,Business Analyst,L,5
1.2.3,User Story Documentation,Business Analyst,L,5
1.3,Solution Design,Solution Architect,H,20
1.3.1,Data Modeling,Solution Architect,M,6
1.3.2,Security Design,Security Architect,M,6
1.3.3,Integration Design,Integration Architect,H,8
1.4,Configuration,Salesforce Consultant,H,25
1.4.1,Workflow Configuration,Salesforce Consultant,M,7
1.4.2,Validation Rules,Salesforce Consultant,M,8
1.4.3,Custom Objects and Fields,Salesforce Consultant,M,10
1.5,Data Migration,Data Migration Lead,H,15
1.5.1,Data Cleaning,Data Analyst,M,5
1.5.2,Migration Strategy Development,Data Migration Lead,M,5
1.5.3,Execution of Migration,Data Migration Lead,M,5
1.6,Integration Development,Integration Developer,H,20
1.6.1,API Configuration,Integration Developer,M,7
1.6.2,Middleware Setup,Integration Developer,M,7
1.6.3,Testing and Validation of Integrations,QA Engineer,M,6
1.7,Testing,QA Lead,H,20
1.7.1,Unit Testing,QA Engineer,M,7
1.7.2,System Testing,QA Engineer,M,7
1.7.3,User Acceptance Testing (UAT),Business Analyst,M,6
1.8,Training,Training Lead,M,10
1.8.1,Training Material Development,Training Lead,M,5
1.8.2,Training Sessions,Training Lead,M,5
1.9,Go-Live and Support,Deployment Lead,M,10
1.9.1,Production Deployment,Deployment Lead,M,5
1.9.2,Hypercare Support,Support Team,M,5`;

    // Inline CSV data for WBS Salesforce
    const wbsCsv = `Milestone,WBS ID,Task,Task Owner,Duration (days),Description,Notes
Salesforce Implementation Project,1.0,-,Project Manager,120,Overall project covering setup, configuration, integration, and deployment.,
Salesforce Environment Setup,1.1,-,Salesforce Admin,10,Initial setup of Salesforce environments.,
,1.1.1,Development Environment Setup,Salesforce Admin,3,Configure development environment.,
,1.1.2,Testing Environment Setup,Salesforce Admin,3,Configure testing environment.,
,1.1.3,Production Environment Setup,Salesforce Admin,4,Configure production environment.,
Requirements Documentation,1.2,-,Business Analyst,15,Collect and document business requirements.,
,1.2.1,Stakeholder Interviews,Business Analyst,5,Conduct discussions with key stakeholders.,
,1.2.2,Requirement Workshops,Business Analyst,5,Conduct workshops to gather detailed requirements.,
,1.2.3,User Story Documentation,Business Analyst,5,Define and document user stories.,
Solution Design,1.3,-,Solution Architect,20,Design system architecture, data model, and security.,
,1.3.1,Data Modeling,Solution Architect,6,Define entities, relationships, and attributes.,
,1.3.2,Security Design,Security Architect,6,Define roles, permissions, and access levels.,
,1.3.3,Integration Design,Integration Architect,8,Define integration points and strategy.,
Configuration,1.4,-,Salesforce Consultant,25,Configure Sales Cloud features and automation.,
,1.4.1,Workflow Configuration,Salesforce Consultant,7,Define and implement workflows.,
,1.4.2,Validation Rules,Salesforce Consultant,8,Create and test validation rules.,
,1.4.3,Custom Objects and Fields,Salesforce Consultant,10,Create custom objects and fields as needed.,
Data Migration,1.5,-,Data Migration Lead,15,Migrate data from legacy systems.,
,1.5.1,Data Cleaning,Data Analyst,5,Identify and clean legacy data.,
,1.5.2,Migration Strategy Development,Data Migration Lead,5,Develop data migration approach.,
,1.5.3,Execution of Migration,Data Migration Lead,5,Migrate and validate data.,
Integration Development,1.6,-,Integration Developer,20,Develop and configure system integrations.,
,1.6.1,API Configuration,Integration Developer,7,Set up and configure APIs.,
,1.6.2,Middleware Setup,Integration Developer,7,Implement middleware solutions.,
,1.6.3,Testing and Validation of Integrations,QA Engineer,6,Ensure proper data flow between systems.,
Testing,1.7,-,QA Lead,20,Conduct comprehensive system testing.,
,1.7.1,Unit Testing,QA Engineer,7,Test individual system components.,
,1.7.2,System Testing,QA Engineer,7,Validate overall system functionality.,
,1.7.3,User Acceptance Testing (UAT),Business Analyst,6,Conduct final testing with end-users.,
Training,1.8,-,Training Lead,10,Develop and deliver training sessions.,
,1.8.1,Training Material Development,Training Lead,5,Create user manuals and guides.,
,1.8.2,Training Sessions,Training Lead,5,Conduct training for end-users.,
Go-Live and Support,1.9,-,Deployment Lead,10,Deploy the solution and provide hypercare support.,
,1.9.1,Production Deployment,Deployment Lead,5,Deploy the final solution to production.,
,1.9.2,Hypercare Support,Support Team,5,Provide post-go-live support for initial stabilization.`;

    // Inline CSV data for Risk Register
    const riskRegisterCsv = `Risk ID,Risk Description,Impact,Likelihood,Mitigation Plan,Owner,Status
R001,Delays in requirement gathering due to stakeholder unavailability.,High,Medium,"Schedule buffer time, proactive follow-ups, prioritize key stakeholders.",Business Analyst,Open
R002,"Data migration issues (data corruption, loss, duplication).",High,High,"Conduct data profiling, test migration on a sample dataset first.",Data Migration Lead,Open
R003,Integration failures due to API limitations or middleware constraints.,High,Medium,"Conduct feasibility study, have backup integration methods.",Integration Developer,Open
R004,Resistance to change from end users.,Medium,High,"Early user engagement, training workshops, feedback loops.",Training Lead,Open
R005,Performance issues in Salesforce post-implementation.,High,Low,"Conduct load testing, optimize queries, and use Salesforce best practices.",Solution Architect,Open
R006,Scope creep due to additional business requirements.,High,High,"Establish a strong change control process, align scope expectations early.",Project Manager,Open`;

    // Inline CSV data for Daily Scrum
    const dailyScrumCsv = `Date,Team Member,Yesterday’s Work,Today’s Work,Impediments/Blockers,Notes
2024-07-01,Jane,Designed login page,Review mockups,None,
2024-07-01,John,Started authentication,Continue implementation,Waiting on API,`;

    // Inline CSV data for Issue Log
    const issueLogCsv = `Issue ID,Issue Description,Impact,Reported Date,Owner,Resolution Plan,Status
I001,Testing environment not accessible.,High,25-Mar-2025,Salesforce Admin,"Troubleshoot access settings, escalate if needed.",Open
I002,Data inconsistencies found after migration.,High,26-Mar-2025,Data Migration Lead,"Identify root cause, re-run validation checks.",Open
I003,API integration with ERP is failing.,High,27-Mar-2025,Integration Developer,"Debug API configurations, check middleware logs.",Open
I004,Users facing login issues in UAT environment.,Medium,28-Mar-2025,QA Engineer,"Reset access, validate user permissions.",Open`;

    // Inline CSV data for Communication Plan (P- Communication Plan-Table 1.csv)
    const communicationPlanCsv = `Stakeholder/Recipients,Information Needs/Type of Communication,Frequency,Medium/Delivery Method,Responsible
Project Sponsor,"Project status updates, milestone reports, risk assessments",Bi-weekly,"Email, Meetings",Scrum Master
Product Owner,"Detailed progress on user stories, backlog refinement status",Weekly,"Email, Meetings, Reports",Scrum Master
Development Team,"Daily progress, impediments, sprint goals",Daily,Daily Stand-ups,Scrum Master
Key Stakeholders,"Project progress, feature updates, feedback sessions",Sprint Review (Bi-weekly),"Meetings, Demos",Scrum Master
End Users,"Training schedules, system updates",Monthly,"Email, Training Sessions",Training Coordinator
QA Team,"Test plans, bug reports, test results",Weekly,"Email, Reports, Meetings",QA Lead
Project Manager,"Overall project status, budget updates, resource needs",Monthly,"Reports, Meetings",Project Manager`;

    // Inline CSV data for Gantt Chart (Gantt_Chart-Salesforce_Gantt_Chart.csv)
    const ganttChartCsv = `WBS Number,Task Title,Task Owner,Start Date,Due Date,Duration,PCT of Task Complete,Week 1,Week 2,Week 3,Week 4,Week 5
1,Project Initiation,Project Manager,01-Apr-2025,07-Apr-2025,7,100%,███,,,,
1.1,Requirement Gathering,Business Analyst,02-Apr-2025,10-Apr-2025,9,80%,███,███,,,
1.2,Stakeholder Alignment,PMO,03-Apr-2025,08-Apr-2025,6,70%,███,███,,,
2,Planning & Design,Solution Architect,08-Apr-2025,17-Apr-2025,10,50%,,███,███,,
2.1,System Architecture,Solution Architect,09-Apr-2025,13-Apr-2025,5,30%,,███,,,
2.2,Data Migration Plan,Data Analyst,10-Apr-2025,15-Apr-2025,6,20%,,███,███,,
3,Development & Customization,Salesforce Developer,18-Apr-2025,10-May-2025,23,0%,,,███,███,███
3.1,Configure Salesforce Objects,Salesforce Admin,19-Apr-2025,25-Apr-2025,7,0%,,,███,,
3.2,Custom Development,Salesforce Developer,26-Apr-2025,06-May-2025,11,0%,,,,███,
4,Testing & Deployment,QA Team,11-May-2025,20-May-2025,10,0%,,,,,███
4.1,UAT Testing,QA Team,12-May-2025,15-May-2025,4,0%,,,,,███
4.2,Final Go-Live,IT Team,18-May-2025,20-May-2025,3,0%,,,,,███`;

    // Inline CSV data for Change Log (Change Log.csv)
    const changeLogCsv = `Change ID,Change Description,Impact,Requested By,Approval Status,Implementation Date,Owner
C001,Additional validation rules required for Opportunity object.,Medium,Sales Team,Approved,30-Mar-2025,Salesforce Consultant
C002,Modify data migration strategy due to unexpected data formats.,High,Data Migration Lead,Approved,02-Apr-2025,Data Migration Lead
C003,Extend UAT by one week for additional user feedback.,High,Business Analyst,Pending,TBD,QA Lead
C004,New security roles required for different departments.,Medium,IT Security Team,Approved,05-Apr-2025,Security Architect`;

    // Inline CSV data for Resource Planning (Resource Planning.csv)
    const resourcePlanningCsv = `Project: Salesforce Sales Cloud Implementation Comprehensive Resource Planning,,,
Budget,,,
Category,Estimated Cost,Details,
Salesforce Licenses,"$ 50,000","50 user licenses for development, testing, and end-users",
Development and Integration,"$ 150,000",Cost for 4 developers and 2 integration specialists over the project duration,
Training,"$ 20,000",Training materials and sessions for end-users,
Testing and QA,"$ 30,000","Testing tools, environment setup, and QA team",
Project Management,"$ 40,000",Project manager and Scrum Master costs,
Contingency,"$ 20,000",Reserve for unexpected expenses,
Total,"$ 310,000",,
,,,
People,,,
Role,Number of People,Skills/Qualifications,Responsibilities
Project Manager,1,"PMP/Agile Certification, Experience in Salesforce Implementations","Overall project oversight, budget management, stakeholder communication"
Product Owner,1,Strong understanding of sales processes and Salesforce capabilities,"Define and prioritize Product Backlog, stakeholder requirements"
Scrum Master,1,"Certified Scrum Master, Agile project management experience","Facilitate Scrum ceremonies, remove impediments, support team"
Developers,4,"Experience in Salesforce development, Apex, Visualforce, Lightning",Develop and configure Salesforce features
Integration Specialist,2,Expertise in integrating Salesforce with ERP and other systems,Ensure seamless data integration between systems
QA/Testers,2,"Experience in Salesforce testing, automated testing tools","Conduct testing, report bugs, ensure quality deliverables"
Trainers,2,Experience in training end users on Salesforce,Develop and deliver training sessions
End User Representatives,3,Sales team members familiar with current sales processes,"Provide feedback, participate in UAT"
,,,
Materials,,,
Material,Quantity,Purpose,Details
Laptops/Workstations,8,"Development, testing, and training",High-performance laptops for development and testing
Salesforce Licenses,50,"User access for development, testing, and end-users",1-year subscription for all users
Development Tools,N/A,"IDEs, version control systems, CI tools","IntelliJ IDEA, Git, Jenkins, etc."
Training Materials,N/A,"Training manuals, user guides, online training modules",Comprehensive guides and e-learning materials
,,,
Other Items,,,
Item,Purpose,Details,
Meeting Rooms,"For team meetings, sprint planning, reviews, and retrospectives","Booked through company facilities, equipped with AV tools",
Video Conferencing Tools,For remote meetings and collaboration,"Zoom, Microsoft Teams, or similar",
Project Management Software,"To manage project tasks, track progress, and collaborate","Jira for task management, Confluence for documentation",
Miscellaneous Expenses,"Travel, accommodations for trainers, incidental expenses","Budget for travel, accommodations, and other incidental costs",`;

    // Inline CSV data for QM-Test Execution Report (QM-Test Execution Report.csv)
    const testExecutionReportCsv = `Test Type,Total Cases,Passed,Failed,Pending,Pass Rate,Status
Unit Testing,150,145,5,0,97%,Completed
System Integration,120,110,8,2,91%,In Progress
User Acceptance Test,200,180,15,5,90%,In Progress
Performance Test,50,40,7,3,80%,Pending`;

    // Inline CSV data for Team Performance-Individual Team Member Performance Report (Team Performance-Individual Team Member Performance Report.csv)
    const teamPerformanceReportCsv = `Team Member,Tasks Assigned,Tasks Completed,Avg. Completion Time (Days),Quality Score,Overall Rating
Dev A,10,9,2.5,4.7/5,⭐⭐⭐⭐☆ (Good)
QA B,12,12,1.8,4.9/5,⭐⭐⭐⭐⭐ (Excellent)
UX C,8,6,3.0,4.2/5,⭐⭐⭐☆☆ (Needs Improvement)
PM D,15,14,2.0,4.6/5,⭐⭐⭐⭐☆ (Good)`;

    // Inline CSV data for ROAM Analysis
    const roamAnalysisCsv = `ROAM Analysis,,,
,Issues,Actions,ROAM Designation
Issue 1,10% of plants are not being potted properly.,You contacted the warehouse to update the potting process and have had no issues for two weeks.,Resolved
Issue 2,Customers are complaining.,"Your team reached out to the customers, listened to their issues, and offered to send them a free round of new plants. Most customers were satisfied with this solution.",Mitigated
Issue 3,There is a software issue preventing your customer relations team receiving all requests and complaints.,You assign your IT Specialist to fix the problem as soon as possible.,Owned
Issue 4,Some customers are canceling their subscriptions.,"Your team checks in with the customers and, despite offering them a subscription promotion, they still want to cancel. There is nothing you can do, but the impact is minimal.",Accepted
Issue 5,There are not enough delivery drivers.,You assign your HR Specialist to schedule a hiring day to hire and onboard more drivers.,Resolved
Issue 6,Plants are being delivered late.,"Your team reassessed the delivery routes, making them more efficient and minimizing late deliveries.",Mitigated
Issue 7,Your budget is tightening.,Your Financial Analyst reassessed project spending and was able to increase the budget. The additional money was enough to offset recent losses.,Mitigated`;

    // Inline CSV data for Budget
    const budgetCsv = `Budget: Salesforce Sales Cloud Implementation,,,,,,,,,
,,,,,,,TARGET BUDGET,ACTUAL/FINAL SPEND,"UNDER/
OVER"
,,,,,,," $	300,020.00 "," $	301,020.00 "," $	(1,000.00)"
,,,,,,,,,
,LABOR,,,MATERIALS,,FIXED COST,BUDGET,ACTUAL,UNDER/OVER
MILESTONES & TASKS,EMPLOYEE,HOURS,RATE,UNITS,$/UNIT(S),,,,
Milestone 1: Project Planning,,,,,,,,,
Task 1: Initial Planning and Setup,Project Manager,100,$100,,,," $	10,000.00 ",,
,Scrum Master,50,$80,,,," $	4,000.00 ",,
,,,,,,Total," $	14,000.00 "," $	15,000.00 "," $	(1,000.00)"
Milestone 2: Development,,,,,,, $	-   ,,
Task 1: Salesforce Configuration,Developers (4),2000,$50,,,," $	100,000.00 ",,
Task 2:Development Tools,,,,,,, $	-   ,,
,,,,,,Total," $	100,000.00 "," $	105,000.00 "," $	(5,000.00)"
Milestone 3: Integration,,,,,,, $	-   ,,
Task 1: ERP System Integration,Integration Specialist,600,$50,,,," $	30,000.00 ",,
,,,,,,Total," $	30,000.00 "," $	32,000.00 "," $	(2,000.00)"
Milestone 4: Testing and QA,QA/Testers (2),800,$25,1,$20,," $	20,020.00 ",,
Task 1: Testing and Quality Assurance,,,,,,, $	-   ,,
Task 2: Testing Tools,,,,,,, $	-   ,,
,,,,,,Total," $	20,020.00 "," $	19,020.00 "," $	1,000.00 "
Milestone 5: Training,,,,,,, $	-   ,,
Task 1: User Training Sessions,Trainers (2),400,$40,,,," $	16,000.00 ",,
Task 2: Training Materials,,,,,,, $	-   ,,
,,,,,,Total," $	16,000.00 "," $	14,000.00 "," $	2,000.00 "
Milestone 6: Deployment,,,,,,, $	-   ,,
Task 1: Deployment and Go-Live Support,Development Team,600,$50,,,," $	30,000.00 ",,
,,,,,,Total," $	30,000.00 "," $	28,000.00 "," $	2,000.00 "
Milestone 7: Project Management,,,,,,, $	-   ,,
Task 1: Ongoing Project Management,Project Manager,200,$100,,,," $	20,000.00 ",,
,,,,,,Total," $	20,000.00 "," $	20,000.00 ", $	-   
Milestone 8:  Licenses,,,,,,, $	-   ,,
Task 1: Salesforce Licenses,,,, $	50.00 ,"$1,000",," $	50,000.00 ",,
,,,,,,Total," $	50,000.00 "," $	50,000.00 ", $	-   
Reserve buffer (Contingency),,,,,,," $	20,000.00 "," $	18,000.00 "," $	2,000.00 "
TOTAL,,,,,,," $	300,020.00 "," $	301,020.00 "," $	(1,000.00)"`;

    // Inline CSV for Release Plan
    const releasePlanCsv = `Release Plan: Application Deployment
,Release Name,Version,Release Date,Key Features,Status,Notes
Phase 1: Initial Deployment,V1.0.0,2024-07-15,"User Authentication, Basic Profile Management",Completed,Smooth deployment,
Phase 2: Feature Enhancements,V1.1.0,2024-08-30,"Advanced Search, Notification System",In Progress,Some delays in notification system,
Phase 3: Performance Optimizations,V1.2.0,2024-10-15,"Database Query Optimization, Caching Mechanisms",Planned,Requires thorough testing,
Phase 4: Mobile App Integration,V1.3.0,2024-12-01,"iOS and Android App Development",Planned,Resource allocation needed,`;

    // Inline CSV for Project Status Report
    const projectStatusReportCsv = `Project Status Report: Salesforce Sales Cloud Implementation,,,,,
Status: In Progress,,,,
Overall Health: Yellow,,,,
Reporting Period: April 1, 2025 - April 30, 2025,,,,
Project Manager: John Doe,,,,
,,,,,,
Key Highlights:,,,,
- Successfully configured Sales Cloud for initial user group.,,,,
- Conducted stakeholder workshops for requirement refinement.,,,,
- Initiated data migration strategy discussions.,,,,
,,,,,,
Work Completed (April 2025):,,,,
- Completed 80% of Sales Cloud basic configuration.,,,,
- Finalized user stories for Leads and Opportunities.,,,,
- Developed initial integration framework for ERP.,,,,
,,,,,,
Upcoming Work (May 2025):,,,,
- Complete remaining Sales Cloud configuration.,,,,
- Begin UAT for Leads and Opportunities modules.,,,,
- Develop detailed integration APIs.,,,,
,,,,,,
Risks/Issues:,,,,
- Data quality concerns identified during initial profiling (High).,,,,
- Potential delay in third-party integration API delivery (Medium).,,,,
- Resource availability for UAT (Medium).,,,,
,,,,,,
Budget Summary:,,,,
Category,Budget,Actual,Variance
Labor,"$150,000","$160,000","($10,000)"
Materials,"$20,000","$18,000","$2,000"
Licenses,"$50,000","$50,000","$0"
Contingency,"$30,000","$25,000","$5,000"
Total,"$250,000","$253,000","($3,000)"
,,,,,,
Schedule Summary:,,,,
Phase,Planned Start,Actual Start,Planned End,Actual End,Status,Variance (Days)
Initiation,2025-03-01,2025-03-01,2025-03-15,2025-03-15,Completed,0
Planning,2025-03-16,2025-03-16,2025-04-15,2025-04-20,In Progress,5
Development,2025-04-16,2025-04-22,2025-06-15,,Not Started,
Testing,2025-06-16,,,2025-07-15,,Not Started,
Deployment,2025-07-16,,,2025-07-30,,Not Started,`;

    // Inline CSV for Project Road Map
    const projectRoadMapCsv = `Project Road Map: Salesforce Sales Cloud Implementation,,,,
Phase,Initiative,Start Date,End Date,Key Milestones,Status
Phase 1: Foundation,Platform Setup,2025-03-01,2025-03-31,"Environment setup, User provisioning",Completed
Phase 1: Foundation,Requirements Gathering,2025-03-15,2025-04-15,"User stories, Functional specifications",In Progress
Phase 2: Core Development,Sales Cloud Configuration,2025-04-01,2025-05-30,"Custom objects, Workflows, Validation rules",In Progress
Phase 2: Core Development,Data Migration Prep,2025-04-15,2025-05-15,"Data mapping, Cleansing plan",In Progress
Phase 3: Integration & Testing,ERP Integration,2025-06-01,2025-07-15,"API development, Middleware setup",Planned
Phase 3: Integration & Testing,UAT & Training,2025-07-01,2025-07-31,"Test cases, User training modules",Planned
Phase 4: Deployment & Post-Go-Live,Go-Live,2025-08-01,2025-08-05,"Production deployment, Cutover",Planned
Phase 4: Deployment & Post-Go-Live,Post-Launch Support,2025-08-05,2025-09-05,"Hypercare, Issue resolution",Planned`;

    // Inline CSV for Team Capacity
    const teamCapacityCsv = `Team Member,Role,Capacity (Person-Days/Week),Allocated (Person-Days/Week),Remaining (Person-Days/Week),Availability (%)
Dev A,Developer,5,4,1,20
QA B,QA Engineer,5,3,2,40
UX C,UX Designer,5,5,0,0
PM D,Project Manager,5,4,1,20
Dev E,Developer,5,2,3,60`;

    // Inline CSV for RACI Chart
    const raciChartCsv = `,,,,,,
Project Name: Salesforce Implementation RACI Matrix,,,,,,
,,,,,,
Activity,Project Manager,Solution Architect,Salesforce Admin,Business Analyst,QA Engineer,Integration Developer
Requirement Gathering,R,A,C,I,C,C
Solution Design,C,R,A,C,I,C
Salesforce Configuration,I,C,R,C,A,C
Data Migration,C,C,I,R,A,C
Integration Development,C,C,C,I,A,R
Testing,I,C,C,C,R,A
Training,C,I,C,A,C,C
Deployment,C,C,A,C,I,R`;

    // Inline CSV for Resource Utilization
    const resourceUtilizationCsv = `Resource,Role,Project,Allocated Hours,Actual Hours,Utilization %
John Doe,Project Manager,Salesforce CRM,160,150,93.75
Jane Smith,Developer,Salesforce CRM,160,170,106.25
Mike Johnson,QA Engineer,Salesforce CRM,160,140,87.50
Emily Davis,Business Analyst,Salesforce CRM,160,165,103.13`;

    // Inline CSV for QM-Defect Tracking Report
    const defectTrackingReportCsv = `Defect ID,Description,Severity,Priority,Status,Assigned To,Detected Date,Resolution Date
D001,Login button not working,High,High,Open,Dev A,2025-05-01,
D002,Incorrect data displayed on dashboard,Medium,High,Open,Dev B,2025-05-02,
D003,User profile update failure,High,Medium,In Progress,Dev C,2025-05-03,2025-05-05
D004,Report generation takes too long,Medium,Low,Closed,Dev A,2025-05-04,2025-05-06
D005,Minor UI alignment issue,Low,Low,Open,UX C,2025-05-05,`;


    // Main React component
    const ProjectManagementReports = () => {
      const [selectedReport, setSelectedReport] = React.useState('workEstimation');
      const [selectedMethodology, setSelectedMethodology] = React.useState('Waterfall');
      const [workEstimationData, setWorkEstimationData] = React.useState([]);
      const [wbsData, setWbsData] = React.useState([]);
      const [riskRegisterData, setRiskRegisterData] = React.useState([]);
      const [dailyScrumData, setDailyScrumData] = React.useState([]);
      const [issueLogData, setIssueLogData] = React.useState([]);
      const [communicationPlanData, setCommunicationPlanData] = React.useState([]);
      const [ganttChartData, setGanttChartData] = React.useState([]);
      const [changeLogData, setChangeLogData] = React.useState([]);
      const [resourcePlanningData, setResourcePlanningData] = React.useState([]);
      const [testExecutionReportData, setTestExecutionReportData] = React.useState([]);
      const [teamPerformanceReportData, setTeamPerformanceReportData] = React.useState([]);
      const [roamAnalysisData, setRoamAnalysisData] = React.useState([]);
      const [budgetData, setBudgetData] = React.useState({ summary: {}, details: [] });
      const [releasePlanData, setReleasePlanData] = React.useState([]);
      const [projectStatusReportData, setProjectStatusReportData] = React.useState({});
      const [projectRoadMapData, setProjectRoadMapData] = React.useState([]);
      // New states for the added reports
      const [teamCapacityData, setTeamCapacityData] = React.useState([]);
      const [raciChartData, setRaciChartData] = React.useState([]);
      const [resourceUtilizationData, setResourceUtilizationData] = React.useState([]);
      const [defectTrackingReportData, setDefectTrackingReportData] = React.useState([]);


      const [loading, setLoading] = React.useState(true);
      const [sortConfig, setSortConfig] = React.useState({ key: null, direction: 'asc' });

      // Helper to clean and parse monetary values
      const parseCurrency = (value) => {
        if (!value) return 0;
        const cleaned = value.replace(/[^0-9.-]+/g, ""); // Remove currency symbols, commas
        return parseFloat(cleaned) || 0;
      };

      // Parsing for new reports
      // Team Capacity
      const processTeamCapacityData = (rawData) => {
          return rawData.map(row => ({
              teamMember: row["Team Member"] ? row["Team Member"].trim() : "",
              role: row["Role"] ? row["Role"].trim() : "",
              capacity: row["Capacity (Person-Days/Week)"] ? parseFloat(row["Capacity (Person-Days/Week)"]) : 0,
              allocated: row["Allocated (Person-Days/Week)"] ? parseFloat(row["Allocated (Person-Days/Week)"]) : 0,
              remaining: row["Remaining (Person-Days/Week)"] ? parseFloat(row["Remaining (Person-Days/Week)"]) : 0,
              availability: row["Availability (%)"] ? parseFloat(row["Availability (%)"]) : 0,
          })).filter(row => row.teamMember);
      };

      // RACI Chart
      const processRaciChartData = (rawData) => {
          // Find the actual header row (row that includes "Activity" and "Project Manager")
          const headerRowIndex = rawData.findIndex(row => row.includes("Activity") && row.includes("Project Manager"));
          if (headerRowIndex === -1) return []; // No header found

          const headers = rawData[headerRowIndex].map(h => h ? h.trim() : '');
          const dataRows = rawData.slice(headerRowIndex + 1);

          return dataRows.map(row => {
              const rowData = {};
              headers.forEach((header, index) => {
                  rowData[header] = row[index] ? row[index].trim() : '';
              });
              return rowData;
          }).filter(row => row.Activity); // Filter out empty rows based on Activity
      };

      // Resource Utilization
      const processResourceUtilizationData = (rawData) => {
          return rawData.map(row => ({
              resource: row["Resource"] ? row["Resource"].trim() : "",
              role: row["Role"] ? row["Role"].trim() : "",
              project: row["Project"] ? row["Project"].trim() : "",
              allocatedHours: row["Allocated Hours"] ? parseFloat(row["Allocated Hours"]) : 0,
              actualHours: row["Actual Hours"] ? parseFloat(row["Actual Hours"]) : 0,
              utilization: row["Utilization %"] ? parseFloat(row["Utilization %"]) : 0,
          })).filter(row => row.resource);
      };

      // Defect Tracking Report
      const processDefectTrackingReportData = (rawData) => {
          return rawData.map(row => ({
              defectId: row["Defect ID"] ? row["Defect ID"].trim() : "",
              description: row["Description"] ? row["Description"].trim() : "",
              severity: row["Severity"] ? row["Severity"].trim() : "",
              priority: row["Priority"] ? row["Priority"].trim() : "",
              status: row["Status"] ? row["Status"].trim() : "",
              assignedTo: row["Assigned To"] ? row["Assigned To"].trim() : "",
              detectedDate: row["Detected Date"] ? row["Detected Date"].trim() : "",
              resolutionDate: row["Resolution Date"] ? row["Resolution Date"].trim() : "",
          })).filter(row => row.defectId);
      };


      // Processing and cleaning Work Estimation data
      const processWorkEstimationData = (rawData) => {
        return rawData.map(row => ({
          wbsLevel: row["WBS Level"] ? row["WBS Level"].trim() : "",
          taskName: row["Task Name"] ? row["Task Name"].trim() : "",
          owner: row["Owner"] ? row["Owner"].trim() : "",
          complexity: row["Complexity"] ? row["Complexity"].trim() : "",
          effort: row["Estimated Effort (Person-Days)"] ? parseFloat(row["Estimated Effort (Person-Days)"]) : 0
        })).filter(row => row.wbsLevel && row.taskName && !isNaN(row.effort));
      };

      // Processing and cleaning WBS data
      const processWbsData = (rawData) => {
        return rawData.map(row => ({
          milestone: row["Milestone"] ? row["Milestone"].trim() : "",
          wbsId: row["WBS ID"] ? row["WBS ID"].trim() : "",
          task: row["Task"] ? row["Task"].trim() : "",
          taskOwner: row["Task Owner"] ? row["Task Owner"].trim() : "",
          duration: row["Duration (days)"] ? parseFloat(row["Duration (days)"]) : 0,
          description: row["Description"] ? row["Description"].trim() : "",
          notes: row["Notes"] ? row["Notes"].trim() : ""
        })).filter(row => row.wbsId && (row.task || row.milestone) && !isNaN(row.duration));
      };

      // Processing and cleaning Risk Register data
      const processRiskRegisterData = (rawData) => {
        return rawData.map(row => ({
          riskId: row["Risk ID"] ? row["Risk ID"].trim() : "",
          riskDescription: row["Risk Description"] ? row["Risk Description"].trim() : "",
          impact: row["Impact"] ? row["Impact"].trim() : "",
          likelihood: row["Likelihood"] ? row["Likelihood"].trim() : "",
          mitigationPlan: row["Mitigation Plan"] ? row["Mitigation Plan"].trim() : "",
          owner: row["Owner"] ? row["Owner"].trim() : "",
          status: row["Status"] ? row["Status"].trim() : ""
        })).filter(row => row.riskId && row.riskDescription);
      };

      // Processing and cleaning Daily Scrum data
      const processDailyScrumData = (rawData) => {
        return rawData.map(row => ({
          date: row["Date"] ? row["Date"].trim() : "",
          teamMember: row["Team Member"] ? row["Team Member"].trim() : "",
          yesterdaysWork: row["Yesterday’s Work"] ? row["Yesterday’s Work"].trim() : "",
          todaysWork: row["Today’s Work"] ? row["Today’s Work"].trim() : "",
          impedimentsBlockers: row["Impediments/Blockers"] ? row["Impediments/Blockers"].trim() : "",
          notes: row["Notes"] ? row["Notes"].trim() : ""
        })).filter(row => row.date && row.teamMember);
      };

      // Processing and cleaning Issue Log data
      const processIssueLogData = (rawData) => {
        return rawData.map(row => ({
          issueId: row["Issue ID"] ? row["Issue ID"].trim() : "",
          issueDescription: row["Issue Description"] ? row["Issue Description"].trim() : "",
          impact: row["Impact"] ? row["Impact"].trim() : "",
          reportedDate: row["Reported Date"] ? row["Reported Date"].trim() : "",
          owner: row["Owner"] ? row["Owner"].trim() : "",
          resolutionPlan: row["Resolution Plan"] ? row["Resolution Plan"].trim() : "",
          status: row["Status"] ? row["Status"].trim() : ""
        })).filter(row => row.issueId && row.issueDescription);
      };

      // Processing and cleaning Communication Plan data
      const processCommunicationPlanData = (rawData) => {
        return rawData.map(row => ({
          stakeholderRecipients: row["Stakeholder/Recipients"] ? row["Stakeholder/Recipients"].trim() : "",
          informationNeedsType: row["Information Needs/Type of Communication"] ? row["Information Needs/Type of Communication"].trim() : "",
          frequency: row["Frequency"] ? row["Frequency"].trim() : "",
          mediumDeliveryMethod: row["Medium/Delivery Method"] ? row["Medium/Delivery Method"].trim() : "",
          responsible: row["Responsible"] ? row["Responsible"].trim() : ""
        })).filter(row => row.stakeholderRecipients && row.informationNeedsType);
      };

      // Processing and cleaning Gantt Chart data
      const processGanttChartData = (rawData) => {
        return rawData.map(row => ({
          wbsNumber: row["WBS Number"] ? row["WBS Number"].trim() : "",
          taskTitle: row["Task Title"] ? row["Task Title"].trim() : "",
          taskOwner: row["Task Owner"] ? row["Task Owner"].trim() : "",
          startDate: row["Start Date"] ? row["Start Date"].trim() : "",
          dueDate: row["Due Date"] ? row["Due Date"].trim() : "",
          duration: row["Duration"] ? parseFloat(row["Duration"]) : 0,
          pctOfTaskComplete: row["PCT of Task Complete"] ? parseFloat(row["PCT of Task Complete"]) : 0,
          week1: row["Week 1"] ? row["Week 1"].trim() : "",
          week2: row["Week 2"] ? row["Week 2"].trim() : "",
          week3: row["Week 3"] ? row["Week 3"].trim() : "",
          week4: row["Week 4"] ? row["Week 4"].trim() : "",
          week5: row["Week 5"] ? row["Week 5"].trim() : ""
        })).filter(row => row.wbsNumber && row.taskTitle && !isNaN(row.duration));
      };

      // Processing and cleaning Change Log data
      const processChangeLogData = (rawData) => {
        return rawData.map(row => ({
          changeId: row["Change ID"] ? row["Change ID"].trim() : "",
          changeDescription: row["Change Description"] ? row["Change Description"].trim() : "",
          impact: row["Impact"] ? row["Impact"].trim() : "",
          requestedBy: row["Requested By"] ? row["Requested By"].trim() : "",
          approvalStatus: row["Approval Status"] ? row["Approval Status"].trim() : "",
          implementationDate: row["Implementation Date"] ? row["Implementation Date"].trim() : "",
          owner: row["Owner"] ? row["Owner"].trim() : ""
        })).filter(row => row.changeId && row.changeDescription);
      };

      // Processing and cleaning Resource Planning data
      const processResourcePlanningData = (rawData) => {
        const budget = [];
        const people = [];
        const materials = [];
        const otherItems = [];

        let currentCategory = '';
        rawData.forEach(row => {
          // Adjusting headers for different sections
          const rowCategory = row.Category?.trim();
          const rowRole = row.Role?.trim();
          const rowMaterial = row.Material?.trim();
          const rowItem = row.Item?.trim();

          if (rowCategory === 'Budget') {
            currentCategory = 'budget';
          } else if (rowRole === 'Role') {
            currentCategory = 'people';
          } else if (rowMaterial === 'Material') {
            currentCategory = 'materials';
          } else if (rowItem === 'Item') {
            currentCategory = 'otherItems';
          }

          if (currentCategory === 'budget' && rowCategory && rowCategory !== 'Budget') {
            budget.push({
              category: rowCategory,
              estimatedCost: row["Estimated Cost"] ? row["Estimated Cost"].trim() : "",
              details: row.Details ? row.Details.trim() : ""
            });
          } else if (currentCategory === 'people' && rowRole && rowRole !== 'Role') {
            people.push({
              role: rowRole,
              numberOfPeople: row["Number of People"] ? parseInt(row["Number of People"]) : 0,
              skillsQualifications: row["Skills/Qualifications"] ? row["Skills/Qualifications"].trim() : "",
              responsibilities: row.Responsibilities ? row.Responsibilities.trim() : ""
            });
          } else if (currentCategory === 'materials' && rowMaterial && rowMaterial !== 'Material') {
            materials.push({
              material: rowMaterial,
              quantity: row.Quantity ? row.Quantity.trim() : "",
              purpose: row.Purpose ? row.Purpose.trim() : "",
              details: row.Details ? row.Details.trim() : ""
            });
          } else if (currentCategory === 'otherItems' && rowItem && rowItem !== 'Item') {
            otherItems.push({
              item: rowItem,
              purpose: row.Purpose ? row.Purpose.trim() : "",
              details: row.Details ? row.Details.trim() : ""
            });
          }
        });
        return { budget, people, materials, otherItems };
      };

      // Processing and cleaning Test Execution Report data
      const processTestExecutionReportData = (rawData) => {
        return rawData.map(row => ({
          testType: row["Test Type"] ? row["Test Type"].trim() : "",
          totalCases: row["Total Cases"] ? parseInt(row["Total Cases"]) : 0,
          passed: row["Passed"] ? parseInt(row["Passed"]) : 0,
          failed: row["Failed"] ? parseInt(row["Failed"]) : 0,
          pending: row["Pending"] ? parseInt(row["Pending"]) : 0,
          passRate: row["Pass Rate"] ? parseFloat(row["Pass Rate"]) : 0,
          status: row["Status"] ? row["Status"].trim() : ""
        })).filter(row => row.testType);
      };

      // Processing and cleaning Team Performance Report data
      const processTeamPerformanceReportData = (rawData) => {
        return rawData.map(row => ({
          teamMember: row["Team Member"] ? row["Team Member"].trim() : "",
          tasksAssigned: row["Tasks Assigned"] ? parseInt(row["Tasks Assigned"]) : 0,
          tasksCompleted: row["Tasks Completed"] ? parseInt(row["Tasks Completed"]) : 0,
          avgCompletionTime: row["Avg. Completion Time (Days)"] ? parseFloat(row["Avg. Completion Time (Days)"]) : 0,
          qualityScore: row["Quality Score"] ? row["Quality Score"].trim() : "",
          overallRating: row["Overall Rating"] ? row["Overall Rating"].trim() : ""
        })).filter(row => row.teamMember);
      };

      // Processing ROAM Analysis data
      const processRoamAnalysisData = (rawData) => {
        const processed = [];
        let dataStarted = false;
        rawData.forEach(row => {
            if (row[0] && row[0].trim() === 'Issue 1') { // Assuming 'Issue 1' marks the start of data
                dataStarted = true;
            }
            if (dataStarted && row[0] && row[0].startsWith('Issue')) {
                processed.push({
                    issue: row[0] ? row[0].trim() : '',
                    issueDescription: row[1] ? row[1].trim() : '',
                    actions: row[2] ? row[2].trim() : '',
                    roamDesignation: row[3] ? row[3].trim() : ''
                });
            }
        });
        return processed;
      };

      // Processing Budget data
      const processBudgetData = (rawData) => {
          let summary = {
              targetBudget: 0,
              actualSpend: 0,
              underOver: 0
          };
          const details = [];
          let currentMilestone = '';
          
          rawData.forEach((row, index) => {
              // Parse global summary
              if (row[7] && row[7].includes('TARGET BUDGET')) {
                  summary.targetBudget = parseCurrency(rawData[index + 1][7]);
                  summary.actualSpend = parseCurrency(rawData[index + 1][8]);
                  summary.underOver = parseCurrency(rawData[index + 1][9]);
              }

              // Parse detailed budget items
              if (row[0] && row[0].startsWith('Milestone')) {
                  currentMilestone = row[0].trim();
              } else if (row[0] && row[0].startsWith('Task')) {
                  details.push({
                      milestone: currentMilestone,
                      task: row[0] ? row[0].trim() : '',
                      employee: row[1] ? row[1].trim() : '',
                      hours: row[2] ? parseFloat(row[2]) : 0,
                      rate: row[3] ? parseCurrency(row[3]) : 0,
                      units: row[4] ? (row[4].trim() === '-' ? '' : parseFloat(row[4])) : '', // Handle '-' for units
                      unitCost: row[5] ? parseCurrency(row[5]) : 0,
                      budget: row[7] ? parseCurrency(row[7]) : 0,
                      actual: row[8] ? parseCurrency(row[8]) : 0,
                      underOver: row[9] ? parseCurrency(row[9]) : 0,
                  });
              } else if (row[0] && row[0].trim() === 'Reserve buffer (Contingency)') {
                   details.push({
                      milestone: 'Contingency',
                      task: 'Reserve buffer (Contingency)',
                      employee: '', hours: 0, rate: 0, units: '', unitCost: 0,
                      budget: row[7] ? parseCurrency(row[7]) : 0,
                      actual: row[8] ? parseCurrency(row[8]) : 0,
                      underOver: row[9] ? parseCurrency(row[9]) : 0,
                  });
              }
          });
          return { summary, details };
      };

      // Processing Release Plan data
      const processReleasePlanData = (rawData) => {
        // Find the actual header row (row starting with "Release Name")
        const headerRowIndex = rawData.findIndex(row => row.includes("Release Name"));
        if (headerRowIndex === -1) return []; // No header found

        const headers = rawData[headerRowIndex];
        const dataRows = rawData.slice(headerRowIndex + 1);

        return dataRows.map(row => {
          const rowData = {};
          headers.forEach((header, index) => {
            rowData[header.trim()] = row[index] ? row[index].trim() : '';
          });
          return rowData;
        }).filter(row => row["Release Name"]); // Filter out empty rows
      };

      // Processing Project Status Report data
      const processProjectStatusReportData = (rawData) => {
          const report = {
              status: '',
              overallHealth: '',
              reportingPeriod: '',
              projectManager: '',
              keyHighlights: [],
              workCompleted: [],
              upcomingWork: [],
              risksIssues: [],
              budgetSummary: [],
              scheduleSummary: []
          };

          let currentSection = '';
          rawData.forEach(row => {
              const firstCell = row[0] ? row[0].trim() : '';

              if (firstCell.startsWith('Status:')) {
                  report.status = firstCell.replace('Status:', '').trim();
              } else if (firstCell.startsWith('Overall Health:')) {
                  report.overallHealth = firstCell.replace('Overall Health:', '').trim();
              } else if (firstCell.startsWith('Reporting Period:')) {
                  report.reportingPeriod = firstCell.replace('Reporting Period:', '').trim();
              } else if (firstCell.startsWith('Project Manager:')) {
                  report.projectManager = firstCell.replace('Project Manager:', '').trim();
              } else if (firstCell === 'Key Highlights:') {
                  currentSection = 'keyHighlights';
              } else if (firstCell === 'Work Completed (April 2025):') {
                  currentSection = 'workCompleted';
              } else if (firstCell === 'Upcoming Work (May 2025):') {
                  currentSection = 'upcomingWork';
              } else if (firstCell === 'Risks/Issues:') {
                  currentSection = 'risksIssues';
              } else if (firstCell === 'Category' && row[1] === 'Budget') { // Start of Budget Summary table
                  currentSection = 'budgetSummary';
                  // Skip header row
              } else if (firstCell === 'Phase' && row[1] === 'Planned Start') { // Start of Schedule Summary table
                  currentSection = 'scheduleSummary';
                  // Skip header row
              } else if (firstCell.startsWith('- ')) { // Bullet points
                  if (currentSection) {
                      report[currentSection].push(firstCell.substring(2).trim());
                  }
              } else if (currentSection === 'budgetSummary' && firstCell && firstCell !== 'Category') {
                  report.budgetSummary.push({
                      category: row[0],
                      budget: parseCurrency(row[1]),
                      actual: parseCurrency(row[2]),
                      variance: parseCurrency(row[3])
                  });
              } else if (currentSection === 'scheduleSummary' && firstCell && firstCell !== 'Phase') {
                  report.scheduleSummary.push({
                      phase: row[0],
                      plannedStart: row[1],
                      actualStart: row[2],
                      plannedEnd: row[3],
                      actualEnd: row[4],
                      status: row[5],
                      varianceDays: row[6] ? parseInt(row[6]) : 0
                  });
              }
          });
          return report;
      };

      // Processing Project Road Map data
      const processProjectRoadMapData = (rawData) => {
        // Find the actual header row (row starting with "Phase")
        const headerRowIndex = rawData.findIndex(row => row.includes("Phase") && row.includes("Initiative"));
        if (headerRowIndex === -1) return []; // No header found

        const headers = rawData[headerRowIndex];
        const dataRows = rawData.slice(headerRowIndex + 1);

        return dataRows.map(row => {
          const rowData = {};
          headers.forEach((header, index) => {
            rowData[header.trim()] = row[index] ? row[index].trim() : '';
          });
          return rowData;
        }).filter(row => row["Phase"] && row["Initiative"]); // Filter out empty rows
      };


      // Loading CSV data
      React.useEffect(() => {
        setLoading(true);
        Promise.all([
          new Promise(resolve => {
            Papa.parse(workEstimationCsv, {
              header: true,
              skipEmptyLines: true,
              transformHeader: header => header.trim().replace(/^"|"$/g, ''),
              transform: (value, header) => value.trim().replace(/^"|"$/g, ''),
              complete: (results) => {
                setWorkEstimationData(processWorkEstimationData(results.data));
                resolve();
              },
              error: (err) => {
                console.error("Error parsing workEstimationCsv:", err);
                resolve();
              }
            });
          }),
          new Promise(resolve => {
            Papa.parse(wbsCsv, {
              header: true,
              skipEmptyLines: true,
              transformHeader: header => header.trim().replace(/^"|"$/g, ''),
              transform: (value, header) => value.trim().replace(/^"|"$/g, ''),
              complete: (results) => {
                setWbsData(processWbsData(results.data));
                resolve();
              },
              error: (err) => {
                console.error("Error parsing wbsCsv:", err);
                resolve();
              }
            });
          }),
          new Promise(resolve => {
            Papa.parse(riskRegisterCsv, {
              header: true,
              skipEmptyLines: true,
              transformHeader: header => header.trim().replace(/^"|"$/g, ''),
              transform: (value, header) => value.trim().replace(/^"|"$/g, ''),
              complete: (results) => {
                setRiskRegisterData(processRiskRegisterData(results.data));
                resolve();
              },
              error: (err) => {
                console.error("Error parsing riskRegisterCsv:", err);
                resolve();
              }
            });
          }),
          new Promise(resolve => {
            Papa.parse(dailyScrumCsv, {
              header: true,
              skipEmptyLines: true,
              transformHeader: header => header.trim().replace(/^"|"$/g, ''),
              transform: (value, header) => value.trim().replace(/^"|"$/g, ''),
              complete: (results) => {
                setDailyScrumData(processDailyScrumData(results.data));
                resolve();
              },
              error: (err) => {
                console.error("Error parsing dailyScrumCsv:", err);
                resolve();
              }
            });
          }),
          new Promise(resolve => {
            Papa.parse(issueLogCsv, {
              header: true,
              skipEmptyLines: true,
              transformHeader: header => header.trim().replace(/^"|"$/g, ''),
              transform: (value, header) => value.trim().replace(/^"|"$/g, ''),
              complete: (results) => {
                setIssueLogData(processIssueLogData(results.data));
                resolve();
              },
              error: (err) => {
                console.error("Error parsing issueLogCsv:", err);
                resolve();
              }
            });
          }),
          new Promise(resolve => {
            Papa.parse(communicationPlanCsv, {
              header: true,
              skipEmptyLines: true,
              transformHeader: header => header.trim().replace(/^"|"$/g, ''),
              transform: (value, header) => value.trim().replace(/^"|"$/g, ''),
              complete: (results) => {
                setCommunicationPlanData(processCommunicationPlanData(results.data));
                resolve();
              },
              error: (err) => {
                console.error("Error parsing communicationPlanCsv:", err);
                resolve();
              }
            });
          }),
          new Promise(resolve => {
            Papa.parse(ganttChartCsv, {
              header: true,
              skipEmptyLines: true,
              transformHeader: header => header.trim().replace(/^"|"$/g, ''),
              transform: (value, header) => value.trim().replace(/^"|"$/g, ''),
              complete: (results) => {
                setGanttChartData(processGanttChartData(results.data));
                resolve();
              },
              error: (err) => {
                console.error("Error parsing ganttChartCsv:", err);
                resolve();
              }
            });
          }),
          new Promise(resolve => {
            Papa.parse(changeLogCsv, {
              header: true,
              skipEmptyLines: true,
              transformHeader: header => header.trim().replace(/^"|"$/g, ''),
              transform: (value, header) => value.trim().replace(/^"|"$/g, ''),
              complete: (results) => {
                setChangeLogData(processChangeLogData(results.data));
                resolve();
              },
              error: (err) => {
                console.error("Error parsing changeLogCsv:", err);
                resolve();
              }
            });
          }),
          new Promise(resolve => {
            Papa.parse(resourcePlanningCsv, {
              header: true,
              skipEmptyLines: true,
              transformHeader: header => header.trim().replace(/^"|"$/g, ''),
              transform: (value, header) => value.trim().replace(/^"|"$/g, ''),
              complete: (results) => {
                setResourcePlanningData(processResourcePlanningData(results.data));
                resolve();
              },
              error: (err) => {
                console.error("Error parsing resourcePlanningCsv:", err);
                resolve();
              }
            });
          }),
          new Promise(resolve => {
            Papa.parse(testExecutionReportCsv, {
              header: true,
              skipEmptyLines: true,
              transformHeader: header => header.trim().replace(/^"|"$/g, ''),
              transform: (value, header) => value.trim().replace(/^"|"$/g, ''),
              complete: (results) => {
                setTestExecutionReportData(processTestExecutionReportData(results.data));
                resolve();
              },
              error: (err) => {
                console.error("Error parsing testExecutionReportCsv:", err);
                resolve();
              }
            });
          }),
          new Promise(resolve => {
            Papa.parse(teamPerformanceReportCsv, {
              header: true,
              skipEmptyLines: true,
              transformHeader: header => header.trim().replace(/^"|"$/g, ''),
              transform: (value, header) => value.trim().replace(/^"|"$/g, ''),
              complete: (results) => {
                setTeamPerformanceReportData(processTeamPerformanceReportData(results.data));
                resolve();
              },
              error: (err) => {
                console.error("Error parsing teamPerformanceReportCsv:", err);
                resolve();
              }
            });
          }),
          new Promise(resolve => {
            Papa.parse(roamAnalysisCsv, {
              header: false, // Custom parsing for ROAM
              skipEmptyLines: true,
              complete: (results) => {
                setRoamAnalysisData(processRoamAnalysisData(results.data));
                resolve();
              },
              error: (err) => {
                console.error("Error parsing roamAnalysisCsv:", err);
                resolve();
              }
            });
          }),
          new Promise(resolve => {
            Papa.parse(budgetCsv, {
              header: false, // Custom parsing for Budget
              skipEmptyLines: true,
              complete: (results) => {
                setBudgetData(processBudgetData(results.data));
                resolve();
              },
              error: (err) => {
                console.error("Error parsing budgetCsv:", err);
                resolve();
              }
            });
          }),
          new Promise(resolve => {
            Papa.parse(releasePlanCsv, {
              header: false, // Custom parsing for Release Plan
              skipEmptyLines: true,
              complete: (results) => {
                setReleasePlanData(processReleasePlanData(results.data));
                resolve();
              },
              error: (err) => {
                console.error("Error parsing releasePlanCsv:", err);
                resolve();
              }
            });
          }),
          new Promise(resolve => {
            Papa.parse(projectStatusReportCsv, {
              header: false, // Custom parsing for Project Status Report
              skipEmptyLines: true,
              complete: (results) => {
                setProjectStatusReportData(processProjectStatusReportData(results.data));
                resolve();
              },
              error: (err) => {
                console.error("Error parsing projectStatusReportCsv:", err);
                resolve();
              }
            });
          }),
          new Promise(resolve => {
            Papa.parse(projectRoadMapCsv, {
              header: false, // Custom parsing for Project Road Map
              skipEmptyLines: true,
              complete: (results) => {
                setProjectRoadMapData(processProjectRoadMapData(results.data));
                resolve();
              },
              error: (err) => {
                console.error("Error parsing projectRoadMapCsv:", err);
                resolve();
              }
            });
          }),
          // New Reports
          new Promise(resolve => {
            Papa.parse(teamCapacityCsv, {
              header: true,
              skipEmptyLines: true,
              transformHeader: header => header.trim().replace(/^"|"$/g, ''),
              transform: (value, header) => value.trim().replace(/^"|"$/g, ''),
              complete: (results) => {
                setTeamCapacityData(processTeamCapacityData(results.data));
                resolve();
              },
              error: (err) => {
                console.error("Error parsing teamCapacityCsv:", err);
                resolve();
              }
            });
          }),
          new Promise(resolve => {
            Papa.parse(raciChartCsv, {
              header: false, // Custom parsing for RACI Chart
              skipEmptyLines: true,
              complete: (results) => {
                setRaciChartData(processRaciChartData(results.data));
                resolve();
              },
              error: (err) => {
                console.error("Error parsing raciChartCsv:", err);
                resolve();
              }
            });
          }),
          new Promise(resolve => {
            Papa.parse(resourceUtilizationCsv, {
              header: true,
              skipEmptyLines: true,
              transformHeader: header => header.trim().replace(/^"|"$/g, ''),
              transform: (value, header) => value.trim().replace(/^"|"$/g, ''),
              complete: (results) => {
                setResourceUtilizationData(processResourceUtilizationData(results.data));
                resolve();
              },
              error: (err) => {
                console.error("Error parsing resourceUtilizationCsv:", err);
                resolve();
              }
            });
          }),
          new Promise(resolve => {
            Papa.parse(defectTrackingReportCsv, {
              header: true,
              skipEmptyLines: true,
              transformHeader: header => header.trim().replace(/^"|"$/g, ''),
              transform: (value, header) => value.trim().replace(/^"|"$/g, ''),
              complete: (results) => {
                setDefectTrackingReportData(processDefectTrackingReportData(results.data));
                resolve();
              },
              error: (err) => {
                console.error("Error parsing defectTrackingReportCsv:", err);
                resolve();
              }
            });
          })
        ]).then(() => {
          setLoading(false);
        });
      }, []);

      // Sorting function
      const sortData = (data, key, direction) => {
        if (!data || data.length === 0) return [];
        return [...data].sort((a, b) => {
          const aValue = a[key];
          const bValue = b[key];
          if (typeof aValue === 'number') {
            return direction === 'asc' ? aValue - bValue : bValue - aValue;
          }
          return direction === 'asc' 
            ? String(aValue).localeCompare(String(bValue))
            : String(bValue).localeCompare(String(aValue));
        });
      };

      const handleSort = (key) => {
        const direction = sortConfig.key === key && sortConfig.direction === 'asc' ? 'desc' : 'asc';
        setSortConfig({ key, direction });
      };

      // Handle methodology button click
      const handleMethodologyChange = (methodology) => {
        setSelectedMethodology(methodology);
        setSelectedReport('workEstimation'); // Reset to Work Estimation on methodology change
        setSortConfig({ key: null, direction: 'asc' }); // Reset sorting
      };

      // Preparing chart data for Work Estimation
      const workEstimationBarChartData = workEstimationData.reduce((acc, row) => {
        const wbsTopLevel = row.wbsLevel.split('.')[0] + '.' + row.wbsLevel.split('.')[1];
        const existing = acc.find(item => item.wbsLevel === wbsTopLevel);
        if (existing) {
          existing.effort += row.effort;
        } else {
          acc.push({ wbsLevel: wbsTopLevel, effort: row.effort });
        }
        return acc;
      }, []);

      const workEstimationPieChartData = workEstimationData.reduce((acc, row) => {
        const existing = acc.find(item => item.owner === row.owner);
        if (existing) {
          existing.effort += row.effort;
        } else {
          acc.push({ owner: row.owner, effort: row.effort });
        }
        return acc;
      }, []);

      // Preparing chart data for WBS
      const wbsBarChartData = wbsData.reduce((acc, row) => {
        if (row.wbsId.match(/^\d+\.\d+$/)) {
          const existing = acc.find(item => item.milestone === row.milestone);
          if (existing) {
            existing.duration += row.duration;
          } else {
            acc.push({ milestone: row.milestone, duration: row.duration });
          }
        }
        return acc;
      }, []);

      const wbsPieChartData = wbsData.reduce((acc, row) => {
        const existing = acc.find(item => item.taskOwner === row.taskOwner);
        if (existing) {
          existing.duration += row.duration;
        } else {
          acc.push({ taskOwner: row.taskOwner, duration: row.duration });
        }
        return acc;
      }, []);

      // Risk Register Charts Data
      const riskImpactPieData = React.useMemo(() => {
        const impactCounts = {};
        riskRegisterData.forEach(risk => {
          impactCounts[risk.impact] = (impactCounts[risk.impact] || 0) + 1;
        });
        return Object.entries(impactCounts).map(([impact, count]) => ({ impact, count }));
      }, [riskRegisterData]);

      const riskStatusPieData = React.useMemo(() => {
        const statusCounts = {};
        riskRegisterData.forEach(risk => {
          statusCounts[risk.status] = (statusCounts[risk.status] || 0) + 1;
        });
        return Object.entries(statusCounts).map(([status, count]) => ({ status, count }));
      }, [riskRegisterData]);

      const riskOwnerBarData = React.useMemo(() => {
        const ownerCounts = {};
        riskRegisterData.forEach(risk => {
          ownerCounts[risk.owner] = (ownerCounts[risk.owner] || 0) + 1;
        });
        return Object.entries(ownerCounts).map(([owner, count]) => ({ owner, count }));
      }, [riskRegisterData]);

      // Risk Summary
      const highImpactCount = riskRegisterData.filter(r => r.impact === 'High').length;
      const openCount = riskRegisterData.filter(r => r.status.toLowerCase() === 'open').length;
      const closedCount = riskRegisterData.filter(r => r.status.toLowerCase() === 'closed').length;

      // Issue Log Charts Data
      const issueImpactPieData = React.useMemo(() => {
        const impactCounts = {};
        issueLogData.forEach(issue => {
          impactCounts[issue.impact] = (impactCounts[issue.impact] || 0) + 1;
        });
        return Object.entries(impactCounts).map(([impact, count]) => ({ impact, count }));
      }, [issueLogData]);

      const issueStatusPieData = React.useMemo(() => {
        const statusCounts = {};
        issueLogData.forEach(issue => {
          statusCounts[issue.status] = (statusCounts[issue.status] || 0) + 1;
        });
        return Object.entries(statusCounts).map(([status, count]) => ({ status, count }));
      }, [issueLogData]);

      const issueOwnerBarData = React.useMemo(() => {
        const ownerCounts = {};
        issueLogData.forEach(issue => {
          ownerCounts[issue.owner] = (ownerCounts[issue.owner] || 0) + 1;
        });
        return Object.entries(ownerCounts).map(([owner, count]) => ({ owner, count }));
      }, [issueLogData]);

      // Change Log Charts Data
      const changeImpactPieData = React.useMemo(() => {
        const impactCounts = {};
        changeLogData.forEach(change => {
          impactCounts[change.impact] = (impactCounts[change.impact] || 0) + 1;
        });
        return Object.entries(impactCounts).map(([impact, count]) => ({ impact, count }));
      }, [changeLogData]);

      const changeStatusPieData = React.useMemo(() => {
        const statusCounts = {};
        changeLogData.forEach(change => {
          statusCounts[change.approvalStatus] = (statusCounts[change.approvalStatus] || 0) + 1;
        });
        return Object.entries(statusCounts).map(([status, count]) => ({ status, count }));
      }, [changeLogData]);

      // Test Execution Report Charts Data
      const testStatusPieData = React.useMemo(() => {
        const statusCounts = {};
        testExecutionReportData.forEach(test => {
          statusCounts[test.status] = (statusCounts[test.status] || 0) + 1;
        });
        return Object.entries(statusCounts).map(([status, count]) => ({ status, count }));
      }, [testExecutionReportData]);

      const testPassRateBarData = React.useMemo(() => {
        return testExecutionReportData.map(test => ({
          testType: test.testType,
          passRate: test.passRate
        }));
      }, [testExecutionReportData]);

      const testCasesBarData = React.useMemo(() => {
        return testExecutionReportData.map(test => ({
          testType: test.testType,
          totalCases: test.totalCases,
          passed: test.passed,
          failed: test.failed,
          pending: test.pending
        }));
      }, [testExecutionReportData]);

      // Team Performance Report Charts Data
      const teamMemberTasksCompletedBarData = React.useMemo(() => {
        return teamPerformanceReportData.map(member => ({
          teamMember: member.teamMember,
          tasksCompleted: member.tasksCompleted
        }));
      }, [teamPerformanceReportData]);

      const teamMemberAvgCompletionTimeBarData = React.useMemo(() => {
        return teamPerformanceReportData.map(member => ({
          teamMember: member.teamMember,
          avgCompletionTime: member.avgCompletionTime
        }));
      }, [teamPerformanceReportData]);

      // ROAM Analysis Charts Data
      const roamDesignationPieData = React.useMemo(() => {
        const counts = {};
        roamAnalysisData.forEach(item => {
          counts[item.roamDesignation] = (counts[item.roamDesignation] || 0) + 1;
        });
        return Object.entries(counts).map(([name, value]) => ({ name, value }));
      }, [roamAnalysisData]);

      // Budget Charts Data
      const budgetMilestoneBarData = React.useMemo(() => {
        const milestoneBudgets = {};
        budgetData.details.forEach(item => {
            if (item.milestone && item.budget !== undefined) {
                milestoneBudgets[item.milestone] = (milestoneBudgets[item.milestone] || 0) + item.budget;
            }
        });
        // Filter out empty milestone names or those without actual budget
        const filteredData = Object.entries(milestoneBudgets)
            .filter(([milestone, budget]) => milestone && budget > 0)
            .map(([milestone, budget]) => ({ milestone, budget }));

        return filteredData;
      }, [budgetData.details]);

      const budgetActualVsTargetBarData = React.useMemo(() => {
          // Aggregate budget and actual by milestone for the bar chart
          const aggregatedData = {};
          budgetData.details.forEach(item => {
              const milestone = item.milestone || 'Other'; // Group by milestone or 'Other' if no milestone
              if (!aggregatedData[milestone]) {
                  aggregatedData[milestone] = { target: 0, actual: 0 };
              }
              aggregatedData[milestone].target += item.budget;
              aggregatedData[milestone].actual += item.actual;
          });

          // Convert aggregated data to array for Recharts
          const chartData = Object.keys(aggregatedData).map(milestone => ({
              milestone,
              "Target Budget": aggregatedData[milestone].target,
              "Actual Spend": aggregatedData[milestone].actual
          }));
          return chartData;
      }, [budgetData.details]);

      // Release Plan Charts Data
      const releaseStatusPieData = React.useMemo(() => {
        const counts = {};
        releasePlanData.forEach(item => {
          counts[item.Status] = (counts[item.Status] || 0) + 1;
        });
        return Object.entries(counts).map(([name, value]) => ({ name, value }));
      }, [releasePlanData]);

      // Project Status Report Charts Data
      const projectStatusBudgetSummaryChartData = React.useMemo(() => {
        return projectStatusReportData.budgetSummary ? projectStatusReportData.budgetSummary.map(item => ({
          category: item.category,
          budget: item.budget,
          actual: item.actual,
        })) : [];
      }, [projectStatusReportData.budgetSummary]);

      const projectStatusScheduleSummaryChartData = React.useMemo(() => {
        return projectStatusReportData.scheduleSummary ? projectStatusReportData.scheduleSummary.map(item => ({
          phase: item.phase,
          varianceDays: item.varianceDays,
        })) : [];
      }, [projectStatusReportData.scheduleSummary]);

      // Project Road Map Charts Data
      const projectRoadMapStatusPieData = React.useMemo(() => {
        const counts = {};
        projectRoadMapData.forEach(item => {
          counts[item.Status] = (counts[item.Status] || 0) + 1;
        });
        return Object.entries(counts).map(([name, value]) => ({ name, value }));
      }, [projectRoadMapData]);

      const projectRoadMapPhaseBarData = React.useMemo(() => {
        const phaseDuration = {};
        projectRoadMapData.forEach(item => {
          if (item["Start Date"] && item["End Date"]) {
            const startDate = new Date(item["Start Date"]);
            const endDate = new Date(item["End Date"]);
            const duration = (endDate - startDate) / (1000 * 60 * 60 * 24); // Duration in days
            phaseDuration[item.Phase] = (phaseDuration[item.Phase] || 0) + duration;
          }
        });
        return Object.entries(phaseDuration).map(([phase, duration]) => ({ phase, duration }));
      }, [projectRoadMapData]);

      // Team Capacity Charts Data
      const teamCapacityAvailabilityPieData = React.useMemo(() => {
        const totalCapacity = teamCapacityData.reduce((sum, member) => sum + member.capacity, 0);
        const totalAllocated = teamCapacityData.reduce((sum, member) => sum + member.allocated, 0);
        const totalRemaining = teamCapacityData.reduce((sum, member) => sum + member.remaining, 0);

        return [
          { name: "Allocated", value: totalAllocated },
          { name: "Remaining", value: totalRemaining },
        ].filter(item => item.value > 0); // Only show if value exists
      }, [teamCapacityData]);

      const teamCapacityBarData = React.useMemo(() => {
        return teamCapacityData.map(member => ({
          teamMember: member.teamMember,
          capacity: member.capacity,
          allocated: member.allocated,
          remaining: member.remaining,
        }));
      }, [teamCapacityData]);

      // RACI Chart Data (Charts - simple counts for R, A, C, I)
      const raciRoleCounts = React.useMemo(() => {
        const counts = {};
        const roles = raciChartData.length > 0 ? Object.keys(raciChartData[0]).filter(key => key !== 'Activity') : [];

        roles.forEach(role => {
          counts[role] = { R: 0, A: 0, C: 0, I: 0 };
          raciChartData.forEach(activity => {
            const responsibility = activity[role];
            if (responsibility) {
              responsibility.split(',').forEach(char => {
                const c = char.trim();
                if (c === 'R' || c === 'A' || c === 'C' || c === 'I') {
                  counts[role][c]++;
                }
              });
            }
          });
        });
        return Object.entries(counts).map(([role, types]) => ({ role, ...types }));
      }, [raciChartData]);

      // Resource Utilization Charts Data
      const resourceUtilizationBarData = React.useMemo(() => {
        return resourceUtilizationData.map(r => ({
          resource: r.resource,
          utilization: r.utilization,
        }));
      }, [resourceUtilizationData]);

      const resourceHoursBarData = React.useMemo(() => {
        return resourceUtilizationData.map(r => ({
          resource: r.resource,
          allocatedHours: r.allocatedHours,
          actualHours: r.actualHours,
        }));
      }, [resourceUtilizationData]);


      // Defect Tracking Report Charts Data
      const defectStatusPieData = React.useMemo(() => {
        const counts = {};
        defectTrackingReportData.forEach(defect => {
          counts[defect.status] = (counts[defect.status] || 0) + 1;
        });
        return Object.entries(counts).map(([name, value]) => ({ name, value }));
      }, [defectTrackingReportData]);

      const defectSeverityPieData = React.useMemo(() => {
        const counts = {};
        defectTrackingReportData.forEach(defect => {
          counts[defect.severity] = (counts[defect.severity] || 0) + 1;
        });
        return Object.entries(counts).map(([name, value]) => ({ name, value }));
      }, [defectTrackingReportData]);

      const defectAssignedToBarData = React.useMemo(() => {
        const counts = {};
        defectTrackingReportData.forEach(defect => {
          counts[defect.assignedTo] = (counts[defect.assignedTo] || 0) + 1;
        });
        return Object.entries(counts).map(([name, value]) => ({ name, value }));
      }, [defectTrackingReportData]);

      // Rendering loading state
      if (loading) {
        return (
          <div className="flex justify-center items-center h-screen">
            <div className="text-xl font-semibold text-gray-700">Loading...</div>
          </div>
        );
      }

      // Sorting data
      const sortedWorkEstimationData = sortConfig.key ? sortData(workEstimationData, sortConfig.key, sortConfig.direction) : workEstimationData;
      const sortedWbsData = sortConfig.key ? sortData(wbsData, sortConfig.key, sortConfig.direction) : wbsData;
      const sortedRiskRegisterData = sortConfig.key ? sortData(riskRegisterData, sortConfig.key, sortConfig.direction) : riskRegisterData;
      const sortedDailyScrumData = sortConfig.key ? sortData(dailyScrumData, sortConfig.key, sortConfig.direction) : dailyScrumData;
      const sortedIssueLogData = sortConfig.key ? sortData(issueLogData, sortConfig.key, sortConfig.direction) : issueLogData;
      const sortedCommunicationPlanData = sortConfig.key ? sortData(communicationPlanData, sortConfig.key, sortConfig.direction) : communicationPlanData;
      const sortedGanttChartData = sortConfig.key ? sortData(ganttChartData, sortConfig.key, sortConfig.direction) : ganttChartData;
      const sortedChangeLogData = sortConfig.key ? sortData(changeLogData, sortConfig.key, sortConfig.direction) : changeLogData;
      const sortedResourcePlanningBudget = sortConfig.key ? sortData(resourcePlanningData.budget, sortConfig.key, sortConfig.direction) : resourcePlanningData.budget;
      const sortedResourcePlanningPeople = sortConfig.key ? sortData(resourcePlanningData.people, sortConfig.key, sortConfig.direction) : resourcePlanningData.people;
      const sortedResourcePlanningMaterials = sortConfig.key ? sortData(resourcePlanningData.materials, sortConfig.key, sortConfig.direction) : resourcePlanningData.materials;
      const sortedResourcePlanningOtherItems = sortConfig.key ? sortData(resourcePlanningData.otherItems, sortConfig.key, sortConfig.direction) : resourcePlanningData.otherItems;
      const sortedTestExecutionReportData = sortConfig.key ? sortData(testExecutionReportData, sortConfig.key, sortConfig.direction) : testExecutionReportData;
      const sortedTeamPerformanceReportData = sortConfig.key ? sortData(teamPerformanceReportData, sortConfig.key, sortConfig.direction) : teamPerformanceReportData;
      const sortedRoamAnalysisData = sortConfig.key ? sortData(roamAnalysisData, sortConfig.key, sortConfig.direction) : roamAnalysisData;
      const sortedBudgetDataDetails = sortConfig.key ? sortData(budgetData.details, sortConfig.key, sortConfig.direction) : budgetData.details;
      const sortedReleasePlanData = sortConfig.key ? sortData(releasePlanData, sortConfig.key, sortConfig.direction) : releasePlanData;
      const sortedProjectRoadMapData = sortConfig.key ? sortData(projectRoadMapData, sortConfig.key, sortConfig.direction) : projectRoadMapData;
      // Sorted data for new reports
      const sortedTeamCapacityData = sortConfig.key ? sortData(teamCapacityData, sortConfig.key, sortConfig.direction) : teamCapacityData;
      const sortedRaciChartData = sortConfig.key ? sortData(raciChartData, sortConfig.key, sortConfig.direction) : raciChartData;
      const sortedResourceUtilizationData = sortConfig.key ? sortData(resourceUtilizationData, sortConfig.key, sortConfig.direction) : resourceUtilizationData;
      const sortedDefectTrackingReportData = sortConfig.key ? sortData(defectTrackingReportData, sortConfig.key, sortConfig.direction) : defectTrackingReportData;


      // Rendering main content
      return (
        <div className="container mx-auto p-6">
          <h1 className="text-3xl font-bold text-center text-blue-800 mb-6">
            Project Management Reports
          </h1>

          {/* Navigation Buttons */}
          <div className="flex space-x-2 mb-6 overflow-x-auto">
            {['Waterfall', 'Agile', 'XP', 'IT Support [Kanban]'].map(methodology => (
              <button
                key={methodology}
                className={`px-4 py-2 rounded-t-lg font-semibold text-sm ${
                  selectedMethodology === methodology
                    ? 'bg-blue-500 text-white'
                    : 'bg-gray-300 text-gray-700 hover:bg-gray-400'
                }`}
                onClick={() => handleMethodologyChange(methodology)}
              >
                {methodology}
              </button>
            ))}
          </div>

          {/* Dropdown */}
          <div className="mb-6">
            <label htmlFor="reportSelect" className="text-lg font-semibold mr-4">Select Report:</label>
            <select
              id="reportSelect"
              className="p-2 border rounded-md bg-white text-gray-700"
              value={selectedReport}
              onChange={(e) => setSelectedReport(e.target.value)}
            >
              <option value="workEstimation">Work Estimation</option>
              <option value="wbsSalesforce">WBS Salesforce</option>
              <option value="riskRegister">Risk Register</option>
              <option value="dailyScrum">Daily Scrum</option>
              <option value="issueLog">Issue Log</option>
              <option value="communicationPlan">Communication Plan</option>
              <option value="ganttChart">Gantt Chart</option>
              <option value="changeLog">Change Log</option>
              <option value="resourcePlanning">Resource Planning</option>
              <option value="testExecutionReport">Test Execution Report</option>
              <option value="teamPerformanceReport">Team Performance Report</option>
              <option value="roamAnalysis">ROAM Analysis</option>
              <option value="budget">Budget Report</option>
              <option value="releasePlan">Release Plan</option>
              <option value="projectStatusReport">Project Status Report</option>
              <option value="projectRoadMap">Project Road Map</option>
              <option value="teamCapacity">Team Capacity</option> {/* New */}
              <option value="raciChart">RACI Chart</option> {/* New */}
              <option value="resourceUtilization">Resource Utilization</option> {/* New */}
              <option value="defectTrackingReport">Defect Tracking Report</option> {/* New */}
            </select>
          </div>

          {/* Work Estimation Report */}
          {selectedReport === 'workEstimation' && (
            <>
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-blue-500">
                <h2 className="text-xl font-semibold mb-4">Work Estimation Summary ({selectedMethodology})</h2>
                <p className="text-gray-700">
                  The Work Estimation report outlines {workEstimationData.length} tasks with a total effort of {workEstimationData.reduce((sum, row) => sum + row.effort, 0)} person-days under {selectedMethodology} methodology.
                </p>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-blue-500">
                <h2 className="text-xl font-semibold mb-4">Task Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-blue-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('wbsLevel')}>
                        WBS Level {sortConfig.key === 'wbsLevel' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('taskName')}>
                        Task Name {sortConfig.key === 'taskName' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('owner')}>
                        Owner {sortConfig.key === 'owner' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('complexity')}>
                        Complexity {sortConfig.key === 'complexity' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('effort')}>
                        Estimated Effort (Person-Days) {sortConfig.key === 'effort' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedWorkEstimationData.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.wbsLevel}</td>
                        <td className="px-4 py-2 border">{row.taskName}</td>
                        <td className="px-4 py-2 border">{row.owner}</td>
                        <td className="px-4 py-2 border">{row.complexity}</td>
                        <td className="px-4 py-2 border">{row.effort}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-blue-500">
                <h2 className="text-xl font-semibold mb-4">Effort by WBS Level</h2>
                <Recharts.ResponsiveContainer width="100%" height={400}>
                  <Recharts.BarChart data={workEstimationBarChartData} margin={{ top: 20, right: 30, left: 20, bottom: 60 }}>
                    <Recharts.CartesianGrid strokeDasharray="3 3" />
                    <Recharts.XAxis dataKey="wbsLevel" label={{ value: 'WBS Level', position: 'bottom', offset: 10, fontSize: 12 }} tick={{ fontSize: 12 }} />
                    <Recharts.YAxis label={{ value: 'Effort (Person-Days)', angle: -90, position: 'insideLeft', fontSize: 12 }} tick={{ fontSize: 12 }} />
                    <Recharts.Tooltip />
                    <Recharts.Legend />
                    <Recharts.Bar dataKey="effort" fill="#3B82F6" />
                  </Recharts.BarChart>
                </Recharts.ResponsiveContainer>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-blue-500">
                <h2 className="text-xl font-semibold mb-4">Effort Distribution by Owner</h2>
                <Recharts.ResponsiveContainer width="100%" height={400}>
                  <Recharts.PieChart>
                    <Recharts.Pie
                      data={workEstimationPieChartData}
                      dataKey="effort"
                      nameKey="owner"
                      cx="50%"
                      cy="50%"
                      outerRadius={150}
                      fill="#8884d8"
                      label={{ fontSize: 12 }}
                    >
                      {workEstimationPieChartData.map((entry, index) => (
                        <Recharts.Cell key={`cell-${index}`} fill={['#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6', '#EC4899', '#6B7280'][index % 7]} />
                      ))}
                    </Recharts.Pie>
                    <Recharts.Tooltip />
                    <Recharts.Legend />
                  </Recharts.PieChart>
                </Recharts.ResponsiveContainer>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-blue-500">
                <h2 className="text-xl font-semibold mb-4">Conclusion</h2>
                <p className="text-gray-700">
                  The Work Estimation report under {selectedMethodology} highlights significant effort in Configuration, Solution Design, Integration Development, and Testing (20-25 person-days each).
                </p>
              </div>
            </>
          )}

          {/* WBS Salesforce Report */}
          {selectedReport === 'wbsSalesforce' && (
            <>
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-green-500">
                <h2 className="text-xl font-semibold mb-4">WBS Salesforce Summary ({selectedMethodology})</h2>
                <p className="text-gray-700">
                  The WBS report details {wbsData.length} tasks and milestones, totaling {wbsData.reduce((sum, row) => sum + row.duration, 0)} days under {selectedMethodology} methodology. Configuration, Solution Design, and Testing are key duration drivers.
                </p>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-green-500">
                <h2 className="text-xl font-semibold mb-4">Task Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-green-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('milestone')}>
                        Milestone {sortConfig.key === 'milestone' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('wbsId')}>
                        WBS ID {sortConfig.key === 'wbsId' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('task')}>
                        Task {sortConfig.key === 'task' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('taskOwner')}>
                        Task Owner {sortConfig.key === 'taskOwner' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('duration')}>
                        Duration (days) {sortConfig.key === 'duration' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('description')}>
                        Description {sortConfig.key === 'description' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('notes')}>
                        Notes {sortConfig.key === 'notes' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedWbsData.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.milestone}</td>
                        <td className="px-4 py-2 border">{row.wbsId}</td>
                        <td className="px-4 py-2 border">{row.task}</td>
                        <td className="px-4 py-2 border">{row.taskOwner}</td>
                        <td className="px-4 py-2 border">{row.duration}</td>
                        <td className="px-4 py-2 border">{row.description}</td>
                        <td className="px-4 py-2 border">{row.notes}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-green-500">
                <h2 className="text-xl font-semibold mb-4">Duration by Milestone</h2>
                <Recharts.ResponsiveContainer width="100%" height={400}>
                  <Recharts.BarChart data={wbsBarChartData} margin={{ top: 20, right: 30, left: 20, bottom: 60 }}>
                    <Recharts.CartesianGrid strokeDasharray="3 3" />
                    <Recharts.XAxis dataKey="milestone" label={{ value: 'Milestone', position: 'bottom', offset: 10, fontSize: 12 }} tick={{ fontSize: 12, angle: -45, textAnchor: 'end' }} />
                    <Recharts.YAxis label={{ value: 'Duration (Days)', angle: -90, position: 'insideLeft', fontSize: 12 }} tick={{ fontSize: 12 }} />
                    <Recharts.Tooltip />
                    <Recharts.Legend />
                    <Recharts.Bar dataKey="duration" fill="#10B981" />
                  </Recharts.BarChart>
                </Recharts.ResponsiveContainer>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-green-500">
                <h2 className="text-xl font-semibold mb-4">Duration Distribution by Task Owner</h2>
                <Recharts.ResponsiveContainer width="100%" height={400}>
                  <Recharts.PieChart>
                    <Recharts.Pie
                      data={wbsPieChartData}
                      dataKey="duration"
                      nameKey="taskOwner"
                      cx="50%"
                      cy="50%"
                      outerRadius={150}
                      fill="#8884d8"
                      label={{ fontSize: 12 }}
                    >
                      {wbsPieChartData.map((entry, index) => (
                        <Recharts.Cell key={`cell-${index}`} fill={['#10B981', '#3B82F6', '#F59E0B', '#EF4444', '#8B5CF6', '#EC4899', '#6B7280'][index % 7]} />
                      ))}
                    </Recharts.Pie>
                    <Recharts.Tooltip />
                    <Recharts.Legend />
                  </Recharts.PieChart>
                </Recharts.ResponsiveContainer>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-green-500">
                <h2 className="text-xl font-semibold mb-4">Conclusion</h2>
                <p className="text-gray-700">
                  The WBS report under {selectedMethodology} structures the project into key milestones, with Configuration and Solution Design requiring the most time (25 and 20 days, respectively).
                </p>
              </div>
            </>
          )}

          {/* Risk Register Report */}
          {selectedReport === 'riskRegister' && (
            <>
              {/* Risk Summary */}
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-red-500">
                <h2 className="text-xl font-semibold mb-4">Risk Register Summary</h2>
                <p className="text-gray-700">
                  There are <span className="font-bold">{riskRegisterData.length}</span> risks in total:
                  <br />
                  <span className="font-bold">{highImpactCount}</span> are <span className="text-red-500 font-bold">High Impact</span>,
                  <span className="font-bold"> {openCount}</span> <span className="text-yellow-600 font-bold">Open</span> and
                  <span className="font-bold"> {closedCount}</span> <span className="text-green-600 font-bold">Closed</span>.
                </p>
              </div>

              {/* Risk Table */}
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-red-500">
                <h2 className="text-xl font-semibold mb-4">Risk Register Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-red-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('riskId')}>
                        Risk ID {sortConfig.key === 'riskId' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('riskDescription')}>
                        Risk Description {sortConfig.key === 'riskDescription' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('impact')}>
                        Impact {sortConfig.key === 'impact' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('likelihood')}>
                        Likelihood {sortConfig.key === 'likelihood' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('mitigationPlan')}>
                        Mitigation Plan {sortConfig.key === 'mitigationPlan' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('owner')}>
                        Owner {sortConfig.key === 'owner' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('status')}>
                        Status {sortConfig.key === 'status' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedRiskRegisterData.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.riskId}</td>
                        <td className="px-4 py-2 border">{row.riskDescription}</td>
                        <td className="px-4 py-2 border">{row.impact}</td>
                        <td className="px-4 py-2 border">{row.likelihood}</td>
                        <td className="px-4 py-2 border">{row.mitigationPlan}</td>
                        <td className="px-4 py-2 border">{row.owner}</td>
                        <td className="px-4 py-2 border">{row.status}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
              {/* Risk Register Charts */}
              <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-red-500">
                  <h3 className="font-semibold mb-2">Risks by Impact</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.PieChart>
                      <Recharts.Pie
                        data={riskImpactPieData}
                        dataKey="count"
                        nameKey="impact"
                        cx="50%"
                        cy="50%"
                        outerRadius={80}
                        fill="#f87171"
                        label
                      >
                        {riskImpactPieData.map((entry, idx) => (
                          <Recharts.Cell key={`cell-${idx}`} fill={['#ef4444','#f59e0b','#10b981'][idx % 3]} />
                        ))}
                      </Recharts.Pie>
                      <Recharts.Tooltip />
                      <Recharts.Legend />
                    </Recharts.PieChart>
                  </Recharts.ResponsiveContainer>
                </div>
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-red-500">
                  <h3 className="font-semibold mb-2">Risks by Status</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.PieChart>
                      <Recharts.Pie
                        data={riskStatusPieData}
                        dataKey="count"
                        nameKey="status"
                        cx="50%"
                        cy="50%"
                        outerRadius={80}
                        fill="#60a5fa"
                        label
                      >
                        {riskStatusPieData.map((entry, idx) => (
                          <Recharts.Cell key={`cell-${idx}`} fill={['#f59e0b', '#10b981'][idx % 2]} />
                        ))}
                      </Recharts.Pie>
                      <Recharts.Tooltip />
                      <Recharts.Legend />
                    </Recharts.PieChart>
                  </Recharts.ResponsiveContainer>
                </div>
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-red-500">
                  <h3 className="font-semibold mb-2">Risks by Owner</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.BarChart data={riskOwnerBarData}>
                      <Recharts.CartesianGrid strokeDasharray="3 3" />
                      <Recharts.XAxis dataKey="owner" tick={{ fontSize: 12 }} />
                      <Recharts.YAxis allowDecimals={false} />
                      <Recharts.Tooltip />
                      <Recharts.Bar dataKey="count" fill="#38bdf8" />
                    </Recharts.BarChart>
                  </Recharts.ResponsiveContainer>
                </div>
              </div>

              {/* Conclusion */}
              <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-red-500">
                <h2 className="text-xl font-semibold mb-4">Conclusion</h2>
                <p className="text-gray-700">
                  The Risk Register highlights the main threats to project delivery.
                  Proactive risk management, including strong stakeholder engagement, technical planning, and change control,
                  is essential to address high-impact and high-likelihood risks such as requirement delays, scope creep, and data migration.
                </p>
              </div>
            </>
          )}

          {/* Daily Scrum Report */}
          {selectedReport === 'dailyScrum' && (
            <>
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-yellow-500">
                <h2 className="text-xl font-semibold mb-4">Daily Scrum Summary</h2>
                <p className="text-gray-700">
                  This report summarizes the daily scrum updates from the team, focusing on progress, current tasks, and impediments.
                </p>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-yellow-500">
                <h2 className="text-xl font-semibold mb-4">Daily Scrum Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-yellow-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('date')}>
                        Date {sortConfig.key === 'date' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('teamMember')}>
                        Team Member {sortConfig.key === 'teamMember' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('yesterdaysWork')}>
                        Yesterday’s Work {sortConfig.key === 'yesterdaysWork' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('todaysWork')}>
                        Today’s Work {sortConfig.key === 'todaysWork' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('impedimentsBlockers')}>
                        Impediments/Blockers {sortConfig.key === 'impedimentsBlockers' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('notes')}>
                        Notes {sortConfig.key === 'notes' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedDailyScrumData.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.date}</td>
                        <td className="px-4 py-2 border">{row.teamMember}</td>
                        <td className="px-4 py-2 border">{row.yesterdaysWork}</td>
                        <td className="px-4 py-2 border">{row.todaysWork}</td>
                        <td className="px-4 py-2 border">{row.impedimentsBlockers}</td>
                        <td className="px-4 py-2 border">{row.notes}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              {/* No charts for Daily Scrum, so directly to conclusion */}
              <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-yellow-500">
                <h2 className="text-xl font-semibold mb-4">Conclusion</h2>
                <p className="text-gray-700">
                  The Daily Scrum report provides a quick overview of team progress and immediate blockers, fostering transparency and accountability.
                </p>
              </div>
            </>
          )}

          {/* Issue Log Report */}
          {selectedReport === 'issueLog' && (
            <>
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-purple-500">
                <h2 className="text-xl font-semibold mb-4">Issue Log Summary</h2>
                <p className="text-gray-700">
                  The Issue Log tracks and manages all identified issues, their impact, and resolution plans. There are currently {issueLogData.length} issues logged.
                </p>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-purple-500">
                <h2 className="text-xl font-semibold mb-4">Issue Log Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-purple-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('issueId')}>
                        Issue ID {sortConfig.key === 'issueId' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('issueDescription')}>
                        Issue Description {sortConfig.key === 'issueDescription' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('impact')}>
                        Impact {sortConfig.key === 'impact' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('reportedDate')}>
                        Reported Date {sortConfig.key === 'reportedDate' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('owner')}>
                        Owner {sortConfig.key === 'owner' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('resolutionPlan')}>
                        Resolution Plan {sortConfig.key === 'resolutionPlan' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('status')}>
                        Status {sortConfig.key === 'status' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedIssueLogData.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.issueId}</td>
                        <td className="px-4 py-2 border">{row.issueDescription}</td>
                        <td className="px-4 py-2 border">{row.impact}</td>
                        <td className="px-4 py-2 border">{row.reportedDate}</td>
                        <td className="px-4 py-2 border">{row.owner}</td>
                        <td className="px-4 py-2 border">{row.resolutionPlan}</td>
                        <td className="px-4 py-2 border">{row.status}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-purple-500">
                  <h3 className="font-semibold mb-2">Issues by Impact</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.PieChart>
                      <Recharts.Pie
                        data={issueImpactPieData}
                        dataKey="count"
                        nameKey="impact"
                        cx="50%"
                        cy="50%"
                        outerRadius={80}
                        fill="#a78bfa"
                        label
                      >
                        {issueImpactPieData.map((entry, idx) => (
                          <Recharts.Cell key={`cell-${idx}`} fill={['#ef4444','#f59e0b','#10b981'][idx % 3]} />
                        ))}
                      </Recharts.Pie>
                      <Recharts.Tooltip />
                      <Recharts.Legend />
                    </Recharts.PieChart>
                  </Recharts.ResponsiveContainer>
                </div>
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-purple-500">
                  <h3 className="font-semibold mb-2">Issues by Status</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.PieChart>
                      <Recharts.Pie
                        data={issueStatusPieData}
                        dataKey="count"
                        nameKey="status"
                        cx="50%"
                        cy="50%"
                        outerRadius={80}
                        fill="#818cf8"
                        label
                      >
                        {issueStatusPieData.map((entry, idx) => (
                          <Recharts.Cell key={`cell-${idx}`} fill={['#f59e0b', '#10b981'][idx % 2]} />
                        ))}
                      </Recharts.Pie>
                      <Recharts.Tooltip />
                      <Recharts.Legend />
                    </Recharts.PieChart>
                  </Recharts.ResponsiveContainer>
                </div>
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-purple-500">
                  <h3 className="font-semibold mb-2">Issues by Owner</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.BarChart data={issueOwnerBarData}>
                      <Recharts.CartesianGrid strokeDasharray="3 3" />
                      <Recharts.XAxis dataKey="owner" tick={{ fontSize: 12 }} />
                      <Recharts.YAxis allowDecimals={false} />
                      <Recharts.Tooltip />
                      <Recharts.Bar dataKey="count" fill="#a78bfa" />
                    </Recharts.BarChart>
                  </Recharts.ResponsiveContainer>
                </div>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-purple-500">
                <h2 className="text-xl font-semibold mb-4">Conclusion</h2>
                <p className="text-gray-700">
                  The Issue Log is crucial for proactive problem-solving. Addressing high-impact open issues promptly, especially those related to testing environments and data integrity, is vital for project success.
                </p>
              </div>
            </>
          )}

          {/* Communication Plan Report */}
          {selectedReport === 'communicationPlan' && (
            <>
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-indigo-500">
                <h2 className="text-xl font-semibold mb-4">Communication Plan Summary</h2>
                <p className="text-gray-700">
                  This communication plan outlines how information will be shared with various stakeholders throughout the project lifecycle. It covers {communicationPlanData.length} key communication types.
                </p>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-indigo-500">
                <h2 className="text-xl font-semibold mb-4">Communication Plan Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-indigo-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('stakeholderRecipients')}>
                        Stakeholder/Recipients {sortConfig.key === 'stakeholderRecipients' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('informationNeedsType')}>
                        Information Needs/Type of Communication {sortConfig.key === 'informationNeedsType' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('frequency')}>
                        Frequency {sortConfig.key === 'frequency' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('mediumDeliveryMethod')}>
                        Medium/Delivery Method {sortConfig.key === 'mediumDeliveryMethod' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('responsible')}>
                        Responsible {sortConfig.key === 'responsible' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedCommunicationPlanData.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.stakeholderRecipients}</td>
                        <td className="px-4 py-2 border">{row.informationNeedsType}</td>
                        <td className="px-4 py-2 border">{row.frequency}</td>
                        <td className="px-4 py-2 border">{row.mediumDeliveryMethod}</td>
                        <td className="px-4 py-2 border">{row.responsible}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              {/* No charts for Communication Plan, so directly to conclusion */}
              <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-indigo-500">
                <h2 className="text-xl font-semibold mb-4">Conclusion</h2>
                <p className="text-gray-700">
                  An effective communication plan ensures that all stakeholders are kept informed, fostering transparency and collaboration throughout the project. Regular updates and tailored communication methods are key.
                </p>
              </div>
            </>
          )}

          {/* Gantt Chart Report */}
          {selectedReport === 'ganttChart' && (
            <>
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-pink-500">
                <h2 className="text-xl font-semibold mb-4">Gantt Chart Summary</h2>
                <p className="text-gray-700">
                  The Gantt Chart provides a visual representation of project tasks against a timeline, showing dependencies and progress. It covers {ganttChartData.length} tasks over several weeks.
                </p>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-pink-500">
                <h2 className="text-xl font-semibold mb-4">Gantt Chart Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-pink-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('wbsNumber')}>
                        WBS Number {sortConfig.key === 'wbsNumber' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('taskTitle')}>
                        Task Title {sortConfig.key === 'taskTitle' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('taskOwner')}>
                        Task Owner {sortConfig.key === 'taskOwner' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('startDate')}>
                        Start Date {sortConfig.key === 'startDate' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('dueDate')}>
                        Due Date {sortConfig.key === 'dueDate' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('duration')}>
                        Duration (days) {sortConfig.key === 'duration' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('pctOfTaskComplete')}>
                        PCT of Task Complete {sortConfig.key === 'pctOfTaskComplete' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border">Week 1</th>
                      <th className="px-4 py-2 border">Week 2</th>
                      <th className="px-4 py-2 border">Week 3</th>
                      <th className="px-4 py-2 border">Week 4</th>
                      <th className="px-4 py-2 border">Week 5</th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedGanttChartData.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.wbsNumber}</td>
                        <td className="px-4 py-2 border">{row.taskTitle}</td>
                        <td className="px-4 py-2 border">{row.taskOwner}</td>
                        <td className="px-4 py-2 border">{row.startDate}</td>
                        <td className="px-4 py-2 border">{row.dueDate}</td>
                        <td className="px-4 py-2 border">{row.duration}</td>
                        <td className="px-4 py-2 border">{row.pctOfTaskComplete}%</td>
                        <td className="px-4 py-2 border">{row.week1}</td>
                        <td className="px-4 py-2 border">{row.week2}</td>
                        <td className="px-4 py-2 border">{row.week3}</td>
                        <td className="px-4 py-2 border">{row.week4}</td>
                        <td className="px-4 py-2 border">{row.week5}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              {/* No charts for Gantt Chart, so directly to conclusion */}
              <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-pink-500">
                <h2 className="text-xl font-semibold mb-4">Conclusion</h2>
                <p className="text-gray-700">
                  The Gantt chart reveals that Project Initiation, Requirement Gathering, and Stakeholder Alignment are progressing well. Planning & Design has started, while Development & Customization and Testing & Deployment are yet to begin or have minimal progress.
                </p>
              </div>
            </>
          )}

          {/* Change Log Report */}
          {selectedReport === 'changeLog' && (
            <>
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-blue-500">
                <h2 className="text-xl font-semibold mb-4">Change Log Summary</h2>
                <p className="text-gray-700">
                  The Change Log documents all requested changes to the project, their impact, approval status, and implementation details. There are {changeLogData.length} changes recorded.
                </p>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-blue-500">
                <h2 className="text-xl font-semibold mb-4">Change Log Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-blue-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('changeId')}>
                        Change ID {sortConfig.key === 'changeId' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('changeDescription')}>
                        Change Description {sortConfig.key === 'changeDescription' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('impact')}>
                        Impact {sortConfig.key === 'impact' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('requestedBy')}>
                        Requested By {sortConfig.key === 'requestedBy' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('approvalStatus')}>
                        Approval Status {sortConfig.key === 'approvalStatus' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('implementationDate')}>
                        Implementation Date {sortConfig.key === 'implementationDate' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('owner')}>
                        Owner {sortConfig.key === 'owner' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedChangeLogData.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.changeId}</td>
                        <td className="px-4 py-2 border">{row.changeDescription}</td>
                        <td className="px-4 py-2 border">{row.impact}</td>
                        <td className="px-4 py-2 border">{row.requestedBy}</td>
                        <td className="px-4 py-2 border">{row.approvalStatus}</td>
                        <td className="px-4 py-2 border">{row.implementationDate}</td>
                        <td className="px-4 py-2 border">{row.owner}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-blue-500">
                  <h3 className="font-semibold mb-2">Changes by Impact</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.PieChart>
                      <Recharts.Pie
                        data={changeImpactPieData}
                        dataKey="count"
                        nameKey="impact"
                        cx="50%"
                        cy="50%"
                        outerRadius={80}
                        fill="#60a5fa"
                        label
                      >
                        {changeImpactPieData.map((entry, idx) => (
                          <Recharts.Cell key={`cell-${idx}`} fill={['#ef4444','#f59e0b','#10b981'][idx % 3]} />
                        ))}
                      </Recharts.Pie>
                      <Recharts.Tooltip />
                      <Recharts.Legend />
                    </Recharts.PieChart>
                  </Recharts.ResponsiveContainer>
                </div>
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-blue-500">
                  <h3 className="font-semibold mb-2">Changes by Approval Status</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.PieChart>
                      <Recharts.Pie
                        data={changeStatusPieData}
                        dataKey="count"
                        nameKey="status"
                        cx="50%"
                        cy="50%"
                        outerRadius={80}
                        fill="#3B82F6"
                        label
                      >
                        {changeStatusPieData.map((entry, idx) => (
                          <Recharts.Cell key={`cell-${idx}`} fill={['#10b981', '#f59e0b', '#ef4444'][idx % 3]} />
                        ))}
                      </Recharts.Pie>
                      <Recharts.Tooltip />
                      <Recharts.Legend />
                    </Recharts.PieChart>
                  </Recharts.ResponsiveContainer>
                </div>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-blue-500">
                <h2 className="text-xl font-semibold mb-4">Conclusion</h2>
                <p className="text-gray-700">
                  The Change Log demonstrates that several high-impact changes have been approved, indicating active adaptation to new requirements or issues. Prompt handling of pending changes, like extending UAT, is critical to avoid project delays.
                </p>
              </div>
            </>
          )}

          {/* Resource Planning Report */}
          {selectedReport === 'resourcePlanning' && (
            <>
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-teal-500">
                <h2 className="text-xl font-semibold mb-4">Resource Planning Summary</h2>
                <p className="text-gray-700">
                  This report details the comprehensive resource planning for the Salesforce Sales Cloud Implementation project, covering budget, people, materials, and other essential items.
                </p>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-teal-500">
                <h2 className="text-xl font-semibold mb-4">Budget Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-teal-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('category')}>
                        Category {sortConfig.key === 'category' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('estimatedCost')}>
                        Estimated Cost {sortConfig.key === 'estimatedCost' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('details')}>
                        Details {sortConfig.key === 'details' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedResourcePlanningBudget.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.category}</td>
                        <td className="px-4 py-2 border">{row.estimatedCost}</td>
                        <td className="px-4 py-2 border">{row.details}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-teal-500">
                <h2 className="text-xl font-semibold mb-4">People Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-teal-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('role')}>
                        Role {sortConfig.key === 'role' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('numberOfPeople')}>
                        Number of People {sortConfig.key === 'numberOfPeople' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('skillsQualifications')}>
                        Skills/Qualifications {sortConfig.key === 'skillsQualifications' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('responsibilities')}>
                        Responsibilities {sortConfig.key === 'responsibilities' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedResourcePlanningPeople.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.role}</td>
                        <td className="px-4 py-2 border">{row.numberOfPeople}</td>
                        <td className="px-4 py-2 border">{row.skillsQualifications}</td>
                        <td className="px-4 py-2 border">{row.responsibilities}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-teal-500">
                <h2 className="text-xl font-semibold mb-4">Materials Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-teal-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('material')}>
                        Material {sortConfig.key === 'material' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('quantity')}>
                        Quantity {sortConfig.key === 'quantity' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('purpose')}>
                        Purpose {sortConfig.key === 'purpose' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('details')}>
                        Details {sortConfig.key === 'details' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedResourcePlanningMaterials.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.material}</td>
                        <td className="px-4 py-2 border">{row.quantity}</td>
                        <td className="px-4 py-2 border">{row.purpose}</td>
                        <td className="px-4 py-2 border">{row.details}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-teal-500">
                <h2 className="text-xl font-semibold mb-4">Other Items Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-teal-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('item')}>
                        Item {sortConfig.key === 'item' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('purpose')}>
                        Purpose {sortConfig.key === 'purpose' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('details')}>
                        Details {sortConfig.key === 'details' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedResourcePlanningOtherItems.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.item}</td>
                        <td className="px-4 py-2 border">{row.purpose}</td>
                        <td className="px-4 py-2 border">{row.details}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
              {/* No charts for Resource Planning, so directly to conclusion */}
              <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-teal-500">
                <h2 className="text-xl font-semibold mb-4">Conclusion</h2>
                <p className="text-gray-700">
                  Resource planning is crucial for the successful execution of the Salesforce Sales Cloud Implementation project. The budget allocates significant funds to development and integration, reflecting the core technical work. The people plan ensures adequate staffing with specialized skills for all project phases.
                </p>
              </div>
            </>
          )}

          {/* Test Execution Report */}
          {selectedReport === 'testExecutionReport' && (
            <>
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-orange-500">
                <h2 className="text-xl font-semibold mb-4">Test Execution Report Summary</h2>
                <p className="text-gray-700">
                  This report summarizes the results of various testing phases, including unit, system integration, user acceptance, and performance tests.
                </p>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-orange-500">
                <h2 className="text-xl font-semibold mb-4">Test Execution Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-orange-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('testType')}>
                        Test Type {sortConfig.key === 'testType' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('totalCases')}>
                        Total Cases {sortConfig.key === 'totalCases' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('passed')}>
                        Passed {sortConfig.key === 'passed' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('failed')}>
                        Failed {sortConfig.key === 'failed' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('pending')}>
                        Pending {sortConfig.key === 'pending' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('passRate')}>
                        Pass Rate {sortConfig.key === 'passRate' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('status')}>
                        Status {sortConfig.key === 'status' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedTestExecutionReportData.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.testType}</td>
                        <td className="px-4 py-2 border">{row.totalCases}</td>
                        <td className="px-4 py-2 border">{row.passed}</td>
                        <td className="px-4 py-2 border">{row.failed}</td>
                        <td className="px-4 py-2 border">{row.pending}</td>
                        <td className="px-4 py-2 border">{row.passRate}%</td>
                        <td className="px-4 py-2 border">{row.status}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-orange-500">
                  <h3 className="font-semibold mb-2">Test Status Distribution</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.PieChart>
                      <Recharts.Pie
                        data={testStatusPieData}
                        dataKey="count"
                        nameKey="status"
                        cx="50%"
                        cy="50%"
                        outerRadius={80}
                        fill="#fbbf24"
                        label
                      >
                        {testStatusPieData.map((entry, idx) => (
                          <Recharts.Cell key={`cell-${idx}`} fill={['#10b981','#f59e0b','#ef4444'][idx % 3]} />
                        ))}
                      </Recharts.Pie>
                      <Recharts.Tooltip />
                      <Recharts.Legend />
                    </Recharts.PieChart>
                  </Recharts.ResponsiveContainer>
                </div>
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-orange-500">
                  <h3 className="font-semibold mb-2">Pass Rate by Test Type</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.BarChart data={testPassRateBarData}>
                      <Recharts.CartesianGrid strokeDasharray="3 3" />
                      <Recharts.XAxis dataKey="testType" tick={{ fontSize: 12 }} />
                      <Recharts.YAxis label={{ value: 'Pass Rate (%)', angle: -90, position: 'insideLeft', fontSize: 12 }} tick={{ fontSize: 12 }} />
                      <Recharts.Tooltip />
                      <Recharts.Bar dataKey="passRate" fill="#f59e0b" />
                    </Recharts.BarChart>
                  </Recharts.ResponsiveContainer>
                </div>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-orange-500">
                <h2 className="text-xl font-semibold mb-4">Test Cases Overview</h2>
                <Recharts.ResponsiveContainer width="100%" height={400}>
                  <Recharts.BarChart data={testCasesBarData} margin={{ top: 20, right: 30, left: 20, bottom: 5 }}>
                    <Recharts.CartesianGrid strokeDasharray="3 3" />
                    <Recharts.XAxis dataKey="testType" />
                    <Recharts.YAxis />
                    <Recharts.Tooltip />
                    <Recharts.Legend />
                    <Recharts.Bar dataKey="totalCases" stackId="a" fill="#3B82F6" name="Total Cases" />
                    <Recharts.Bar dataKey="passed" stackId="a" fill="#10B981" name="Passed" />
                    <Recharts.Bar dataKey="failed" stackId="a" fill="#EF4444" name="Failed" />
                    <Recharts.Bar dataKey="pending" stackId="a" fill="#F59E0B" name="Pending" />
                  </Recharts.BarChart>
                </Recharts.ResponsiveContainer>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-orange-500">
                <h2 className="text-xl font-semibold mb-4">Conclusion</h2>
                <p className="text-gray-700">
                  The Test Execution Report indicates good progress in Unit Testing, with high pass rates. System Integration and User Acceptance Testing are in progress with room for improvement in pass rates. Performance testing is pending, and attention should be given to resolving failed cases to ensure overall system quality.
                </p>
              </div>
            </>
          )}

          {/* Team Performance Report */}
          {selectedReport === 'teamPerformanceReport' && (
            <>
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-lime-500">
                <h2 className="text-xl font-semibold mb-4">Team Performance Report Summary</h2>
                <p className="text-gray-700">
                  This report provides an overview of individual team member performance based on tasks completed, average completion time, and quality scores.
                </p>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-lime-500">
                <h2 className="text-xl font-semibold mb-4">Team Performance Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-lime-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('teamMember')}>
                        Team Member {sortConfig.key === 'teamMember' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('tasksAssigned')}>
                        Tasks Assigned {sortConfig.key === 'tasksAssigned' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('tasksCompleted')}>
                        Tasks Completed {sortConfig.key === 'tasksCompleted' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('avgCompletionTime')}>
                        Avg. Completion Time (Days) {sortConfig.key === 'avgCompletionTime' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('qualityScore')}>
                        Quality Score {sortConfig.key === 'qualityScore' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('overallRating')}>
                        Overall Rating {sortConfig.key === 'overallRating' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedTeamPerformanceReportData.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.teamMember}</td>
                        <td className="px-4 py-2 border">{row.tasksAssigned}</td>
                        <td className="px-4 py-2 border">{row.tasksCompleted}</td>
                        <td className="px-4 py-2 border">{row.avgCompletionTime}</td>
                        <td className="px-4 py-2 border">{row.qualityScore}</td>
                        <td className="px-4 py-2 border">{row.overallRating}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-lime-500">
                  <h3 className="font-semibold mb-2">Tasks Completed by Team Member</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.BarChart data={teamMemberTasksCompletedBarData}>
                      <Recharts.CartesianGrid strokeDasharray="3 3" />
                      <Recharts.XAxis dataKey="teamMember" tick={{ fontSize: 12 }} />
                      <Recharts.YAxis allowDecimals={false} label={{ value: 'Tasks Completed', angle: -90, position: 'insideLeft', fontSize: 12 }} />
                      <Recharts.Tooltip />
                      <Recharts.Bar dataKey="tasksCompleted" fill="#84cc16" />
                    </Recharts.BarChart>
                  </Recharts.ResponsiveContainer>
                </div>
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-lime-500">
                  <h3 className="font-semibold mb-2">Average Completion Time by Team Member</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.BarChart data={teamMemberAvgCompletionTimeBarData}>
                      <Recharts.CartesianGrid strokeDasharray="3 3" />
                      <Recharts.XAxis dataKey="teamMember" tick={{ fontSize: 12 }} />
                      <Recharts.YAxis label={{ value: 'Avg. Completion Time (Days)', angle: -90, position: 'insideLeft', fontSize: 12 }} />
                      <Recharts.Tooltip />
                      <Recharts.Bar dataKey="avgCompletionTime" fill="#d9f99d" />
                    </Recharts.BarChart>
                  </Recharts.ResponsiveContainer>
                </div>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-lime-500">
                <h2 className="text-xl font-semibold mb-4">Conclusion</h2>
                <p className="text-gray-700">
                  The team performance report shows strong performance from QA B and PM D. Dev A has a good completion rate but could aim for higher quality. UX C requires improvement in task completion and quality, suggesting a need for additional support or training.
                </p>
              </div>
            </>
          )}

          {/* ROAM Analysis Report */}
          {selectedReport === 'roamAnalysis' && (
            <>
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-gray-500">
                <h2 className="text-xl font-semibold mb-4">ROAM Analysis Summary</h2>
                <p className="text-gray-700">
                  The ROAM analysis categorizes identified issues based on their designation: Resolved, Owned, Accepted, or Mitigated. There are {roamAnalysisData.length} issues analyzed.
                </p>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-gray-500">
                <h2 className="text-xl font-semibold mb-4">ROAM Analysis Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-gray-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('issue')}>
                        Issue {sortConfig.key === 'issue' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('issueDescription')}>
                        Issue Description {sortConfig.key === 'issueDescription' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('actions')}>
                        Actions {sortConfig.key === 'actions' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('roamDesignation')}>
                        ROAM Designation {sortConfig.key === 'roamDesignation' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedRoamAnalysisData.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.issue}</td>
                        <td className="px-4 py-2 border">{row.issueDescription}</td>
                        <td className="px-4 py-2 border">{row.actions}</td>
                        <td className="px-4 py-2 border">{row.roamDesignation}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-gray-500">
                <h2 className="text-xl font-semibold mb-4">ROAM Designation Distribution</h2>
                <Recharts.ResponsiveContainer width="100%" height={400}>
                  <Recharts.PieChart>
                    <Recharts.Pie
                      data={roamDesignationPieData}
                      dataKey="value"
                      nameKey="name"
                      cx="50%"
                      cy="50%"
                      outerRadius={150}
                      fill="#8884d8"
                      label={{ fontSize: 12 }}
                    >
                      {roamDesignationPieData.map((entry, index) => (
                        <Recharts.Cell key={`cell-${index}`} fill={['#4F46E5', '#EF4444', '#F59E0B', '#10B981'][index % 4]} />
                      ))}
                    </Recharts.Pie>
                    <Recharts.Tooltip />
                    <Recharts.Legend />
                  </Recharts.PieChart>
                </Recharts.ResponsiveContainer>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-gray-500">
                <h2 className="text-xl font-semibold mb-4">Conclusion</h2>
                <p className="text-gray-700">
                  The ROAM analysis provides a clear status of project issues, with a significant number being Resolved or Mitigated, indicating effective issue management. The 'Owned' and 'Accepted' designations highlight areas requiring ongoing attention or deemed low impact.
                </p>
              </div>
            </>
          )}

          {/* Budget Report */}
          {selectedReport === 'budget' && (
            <>
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-sky-500">
                <h2 className="text-xl font-semibold mb-4">Budget Report Summary</h2>
                <p className="text-gray-700">
                  This report provides a detailed overview of the project budget, including target allocations, actual spend, and variance.
                  Overall Target Budget: <span className="font-bold text-blue-700">${budgetData.summary.targetBudget.toLocaleString()}</span>,
                  Actual Spend: <span className="font-bold text-green-700">${budgetData.summary.actualSpend.toLocaleString()}</span>,
                  Under/Over: <span className={`font-bold ${budgetData.summary.underOver < 0 ? 'text-red-700' : 'text-green-700'}`}>${budgetData.summary.underOver.toLocaleString()}</span>.
                </p>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-sky-500">
                <h2 className="text-xl font-semibold mb-4">Budget Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-sky-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('milestone')}>
                        Milestone {sortConfig.key === 'milestone' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('task')}>
                        Task {sortConfig.key === 'task' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('employee')}>
                        Employee {sortConfig.key === 'employee' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('hours')}>
                        Hours {sortConfig.key === 'hours' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('rate')}>
                        Rate {sortConfig.key === 'rate' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('units')}>
                        Units {sortConfig.key === 'units' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('unitCost')}>
                        $/Unit(s) {sortConfig.key === 'unitCost' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('budget')}>
                        Budget {sortConfig.key === 'budget' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('actual')}>
                        Actual {sortConfig.key === 'actual' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('underOver')}>
                        Under/Over {sortConfig.key === 'underOver' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedBudgetDataDetails.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.milestone}</td>
                        <td className="px-4 py-2 border">{row.task}</td>
                        <td className="px-4 py-2 border">{row.employee}</td>
                        <td className="px-4 py-2 border">{row.hours || '-'}</td>
                        <td className="px-4 py-2 border">{row.rate ? `$${row.rate.toLocaleString()}` : '-'}</td>
                        <td className="px-4 py-2 border">{row.units || '-'}</td>
                        <td className="px-4 py-2 border">{row.unitCost ? `$${row.unitCost.toLocaleString()}` : '-'}</td>
                        <td className="px-4 py-2 border">{row.budget ? `$${row.budget.toLocaleString()}` : '-'}</td>
                        <td className="px-4 py-2 border">{row.actual ? `$${row.actual.toLocaleString()}` : '-'}</td>
                        <td className="px-4 py-2 border">{row.underOver ? `$${row.underOver.toLocaleString()}` : '-'}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-sky-500">
                <h2 className="text-xl font-semibold mb-4">Budget by Milestone</h2>
                <Recharts.ResponsiveContainer width="100%" height={400}>
                    <Recharts.BarChart data={budgetMilestoneBarData} margin={{ top: 20, right: 30, left: 20, bottom: 60 }}>
                        <Recharts.CartesianGrid strokeDasharray="3 3" />
                        <Recharts.XAxis dataKey="milestone" label={{ value: 'Milestone', position: 'bottom', offset: 10, fontSize: 12 }} tick={{ fontSize: 12, angle: -45, textAnchor: 'end' }} />
                        <Recharts.YAxis label={{ value: 'Budget ($)', angle: -90, position: 'insideLeft', fontSize: 12 }} tickFormatter={(value) => `$${value.toLocaleString()}`} />
                        <Recharts.Tooltip formatter={(value) => [`$${value.toLocaleString()}`, 'Budget']} />
                        <Recharts.Legend />
                        <Recharts.Bar dataKey="budget" fill="#0EA5E9" />
                    </Recharts.BarChart>
                </Recharts.ResponsiveContainer>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-sky-500">
                <h2 className="text-xl font-semibold mb-4">Actual vs. Target Spend by Milestone</h2>
                <Recharts.ResponsiveContainer width="100%" height={400}>
                  <Recharts.BarChart
                    data={budgetActualVsTargetBarData}
                    margin={{ top: 20, right: 30, left: 20, bottom: 60 }}
                  >
                    <Recharts.CartesianGrid strokeDasharray="3 3" />
                    <Recharts.XAxis dataKey="milestone" label={{ value: 'Milestone', position: 'bottom', offset: 10, fontSize: 12 }} tick={{ fontSize: 12, angle: -45, textAnchor: 'end' }} />
                    <Recharts.YAxis label={{ value: 'Amount ($)', angle: -90, position: 'insideLeft', fontSize: 12 }} tickFormatter={(value) => `$${value.toLocaleString()}`} />
                    <Recharts.Tooltip formatter={(value) => `$${value.toLocaleString()}`} />
                    <Recharts.Legend />
                    <Recharts.Bar dataKey="Target Budget" fill="#3B82F6" />
                    <Recharts.Bar dataKey="Actual Spend" fill="#10B981" />
                  </Recharts.BarChart>
                </Recharts.ResponsiveContainer>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-sky-500">
                <h2 className="text-xl font-semibold mb-4">Conclusion</h2>
                <p className="text-gray-700">
                  The Budget Report shows that the project is currently slightly over budget. Key areas of overspend should be investigated to bring the project back on track. Careful monitoring of actual versus target spend per milestone is crucial for financial health.
                </p>
              </div>
            </>
          )}

          {/* Release Plan Report */}
          {selectedReport === 'releasePlan' && (
            <>
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-cyan-500">
                <h2 className="text-xl font-semibold mb-4">Release Plan Summary</h2>
                <p className="text-gray-700">
                  This Release Plan outlines the phased deployment of the application, detailing {releasePlanData.length} upcoming releases with their versions, key features, and current status.
                </p>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-cyan-500">
                <h2 className="text-xl font-semibold mb-4">Release Plan Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-cyan-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('Release Name')}>
                        Release Name {sortConfig.key === 'Release Name' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('Version')}>
                        Version {sortConfig.key === 'Version' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('Release Date')}>
                        Release Date {sortConfig.key === 'Release Date' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('Key Features')}>
                        Key Features {sortConfig.key === 'Key Features' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('Status')}>
                        Status {sortConfig.key === 'Status' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('Notes')}>
                        Notes {sortConfig.key === 'Notes' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedReleasePlanData.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row['Release Name']}</td>
                        <td className="px-4 py-2 border">{row['Version']}</td>
                        <td className="px-4 py-2 border">{row['Release Date']}</td>
                        <td className="px-4 py-2 border">{row['Key Features']}</td>
                        <td className="px-4 py-2 border">{row['Status']}</td>
                        <td className="px-4 py-2 border">{row['Notes']}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-cyan-500">
                <h2 className="text-xl font-semibold mb-4">Release Status Distribution</h2>
                <Recharts.ResponsiveContainer width="100%" height={400}>
                  <Recharts.PieChart>
                    <Recharts.Pie
                      data={releaseStatusPieData}
                      dataKey="value"
                      nameKey="name"
                      cx="50%"
                      cy="50%"
                      outerRadius={150}
                      fill="#8884d8"
                      label={{ fontSize: 12 }}
                    >
                      {releaseStatusPieData.map((entry, index) => (
                        <Recharts.Cell key={`cell-${index}`} fill={['#10B981', '#F59E0B', '#60A5FA'][index % 3]} />
                      ))}
                    </Recharts.Pie>
                    <Recharts.Tooltip />
                    <Recharts.Legend />
                  </Recharts.PieChart>
                </Recharts.ResponsiveContainer>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-cyan-500">
                <h2 className="text-xl font-semibold mb-4">Conclusion</h2>
                <p className="text-gray-700">
                  The Release Plan highlights that Phase 1 is completed, Phase 2 is in progress with minor delays, and Phases 3 and 4 are planned. This phased approach allows for incremental delivery and continuous improvement.
                </p>
              </div>
            </>
          )}

          {/* Project Status Report */}
          {selectedReport === 'projectStatusReport' && (
            <>
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-emerald-500">
                <h2 className="text-xl font-semibold mb-4">Project Status Report Summary</h2>
                <p className="text-gray-700">
                  **Status:** {projectStatusReportData.status} <br/>
                  **Overall Health:** <span className={`font-bold ${projectStatusReportData.overallHealth === 'Yellow' ? 'text-yellow-600' : projectStatusReportData.overallHealth === 'Red' ? 'text-red-600' : 'text-green-600'}`}>{projectStatusReportData.overallHealth}</span> <br/>
                  **Reporting Period:** {projectStatusReportData.reportingPeriod} <br/>
                  **Project Manager:** {projectStatusReportData.projectManager}
                </p>
                <h3 className="font-semibold mt-4 mb-2">Key Highlights:</h3>
                <ul className="list-disc list-inside text-gray-700 ml-4">
                  {projectStatusReportData.keyHighlights.map((item, index) => <li key={index}>{item}</li>)}
                </ul>
                <h3 className="font-semibold mt-4 mb-2">Work Completed (April 2025):</h3>
                <ul className="list-disc list-inside text-gray-700 ml-4">
                  {projectStatusReportData.workCompleted.map((item, index) => <li key={index}>{item}</li>)}
                </ul>
                <h3 className="font-semibold mt-4 mb-2">Upcoming Work (May 2025):</h3>
                <ul className="list-disc list-inside text-gray-700 ml-4">
                  {projectStatusReportData.upcomingWork.map((item, index) => <li key={index}>{item}</li>)}
                </ul>
                <h3 className="font-semibold mt-4 mb-2">Risks/Issues:</h3>
                <ul className="list-disc list-inside text-gray-700 ml-4">
                  {projectStatusReportData.risksIssues.map((item, index) => <li key={index}>{item}</li>)}
                </ul>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-emerald-500">
                <h2 className="text-xl font-semibold mb-4">Budget Summary</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-emerald-100">
                      <th className="px-4 py-2 border">Category</th>
                      <th className="px-4 py-2 border">Budget</th>
                      <th className="px-4 py-2 border">Actual</th>
                      <th className="px-4 py-2 border">Variance</th>
                    </tr>
                  </thead>
                  <tbody>
                    {projectStatusReportData.budgetSummary.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.category}</td>
                        <td className="px-4 py-2 border">${row.budget.toLocaleString()}</td>
                        <td className="px-4 py-2 border">${row.actual.toLocaleString()}</td>
                        <td className="px-4 py-2 border">${row.variance.toLocaleString()}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-emerald-500">
                <h2 className="text-xl font-semibold mb-4">Schedule Summary</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-emerald-100">
                      <th className="px-4 py-2 border">Phase</th>
                      <th className="px-4 py-2 border">Planned Start</th>
                      <th className="px-4 py-2 border">Actual Start</th>
                      <th className="px-4 py-2 border">Planned End</th>
                      <th className="px-4 py-2 border">Actual End</th>
                      <th className="px-4 py-2 border">Status</th>
                      <th className="px-4 py-2 border">Variance (Days)</th>
                    </tr>
                  </thead>
                  <tbody>
                    {projectStatusReportData.scheduleSummary.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.phase}</td>
                        <td className="px-4 py-2 border">{row.plannedStart}</td>
                        <td className="px-4 py-2 border">{row.actualStart}</td>
                        <td className="px-4 py-2 border">{row.plannedEnd}</td>
                        <td className="px-4 py-2 border">{row.actualEnd}</td>
                        <td className="px-4 py-2 border">{row.status}</td>
                        <td className="px-4 py-2 border">{row.varianceDays}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
              
              <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-emerald-500">
                  <h3 className="font-semibold mb-2">Budget Overview</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.BarChart data={projectStatusBudgetSummaryChartData}>
                      <Recharts.CartesianGrid strokeDasharray="3 3" />
                      <Recharts.XAxis dataKey="category" />
                      <Recharts.YAxis tickFormatter={(value) => `$${value.toLocaleString()}`} />
                      <Recharts.Tooltip formatter={(value) => `$${value.toLocaleString()}`} />
                      <Recharts.Legend />
                      <Recharts.Bar dataKey="budget" fill="#3B82F6" name="Budget" />
                      <Recharts.Bar dataKey="actual" fill="#10B981" name="Actual" />
                    </Recharts.BarChart>
                  </Recharts.ResponsiveContainer>
                </div>
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-emerald-500">
                  <h3 className="font-semibold mb-2">Schedule Variance by Phase</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.BarChart data={projectStatusScheduleSummaryChartData}>
                      <Recharts.CartesianGrid strokeDasharray="3 3" />
                      <Recharts.XAxis dataKey="phase" />
                      <Recharts.YAxis label={{ value: 'Variance (Days)', angle: -90, position: 'insideLeft' }} />
                      <Recharts.Tooltip />
                      <Recharts.Bar dataKey="varianceDays" fill="#EF4444" />
                    </Recharts.BarChart>
                  </Recharts.ResponsiveContainer>
                </div>
              </div>


              <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-emerald-500">
                <h2 className="text-xl font-semibold mb-4">Conclusion</h2>
                <p className="text-gray-700">
                  The project is in progress with an overall health of yellow, indicating some concerns. While the budget is slightly over, key highlights include successful configuration and requirement refinement. Addressing data quality, third-party API delays, and resource availability for UAT are critical next steps to ensure on-time and on-budget delivery.
                </p>
              </div>
            </>
          )}

          {/* Project Road Map Report */}
          {selectedReport === 'projectRoadMap' && (
            <>
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-violet-500">
                <h2 className="text-xl font-semibold mb-4">Project Road Map Summary</h2>
                <p className="text-gray-700">
                  This Project Road Map outlines the key phases and initiatives for the Salesforce Sales Cloud Implementation, spanning from platform setup to post-launch support. It details {projectRoadMapData.length} initiatives.
                </p>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-violet-500">
                <h2 className="text-xl font-semibold mb-4">Project Road Map Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-violet-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('Phase')}>
                        Phase {sortConfig.key === 'Phase' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('Initiative')}>
                        Initiative {sortConfig.key === 'Initiative' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('Start Date')}>
                        Start Date {sortConfig.key === 'Start Date' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('End Date')}>
                        End Date {sortConfig.key === 'End Date' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('Key Milestones')}>
                        Key Milestones {sortConfig.key === 'Key Milestones' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('Status')}>
                        Status {sortConfig.key === 'Status' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedProjectRoadMapData.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.Phase}</td>
                        <td className="px-4 py-2 border">{row.Initiative}</td>
                        <td className="px-4 py-2 border">{row['Start Date']}</td>
                        <td className="px-4 py-2 border">{row['End Date']}</td>
                        <td className="px-4 py-2 border">{row['Key Milestones']}</td>
                        <td className="px-4 py-2 border">{row.Status}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-violet-500">
                  <h3 className="font-semibold mb-2">Initiative Status Distribution</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.PieChart>
                      <Recharts.Pie
                        data={projectRoadMapStatusPieData}
                        dataKey="value"
                        nameKey="name"
                        cx="50%"
                        cy="50%"
                        outerRadius={80}
                        fill="#8B5CF6"
                        label
                      >
                        {projectRoadMapStatusPieData.map((entry, idx) => (
                          <Recharts.Cell key={`cell-${idx}`} fill={['#10B981', '#F59E0B', '#60A5FA'][idx % 3]} />
                        ))}
                      </Recharts.Pie>
                      <Recharts.Tooltip />
                      <Recharts.Legend />
                    </Recharts.PieChart>
                  </Recharts.ResponsiveContainer>
                </div>
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-violet-500">
                  <h3 className="font-semibold mb-2">Phase Duration Overview</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.BarChart data={projectRoadMapPhaseBarData}>
                      <Recharts.CartesianGrid strokeDasharray="3 3" />
                      <Recharts.XAxis dataKey="phase" tick={{ fontSize: 12 }} />
                      <Recharts.YAxis label={{ value: 'Duration (Days)', angle: -90, position: 'insideLeft' }} />
                      <Recharts.Tooltip />
                      <Recharts.Bar dataKey="duration" fill="#A78BFA" />
                    </Recharts.BarChart>
                  </Recharts.ResponsiveContainer>
                </div>
              </div>


              <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-violet-500">
                <h2 className="text-xl font-semibold mb-4">Conclusion</h2>
                <p className="text-gray-700">
                  The Project Road Map provides a clear, phased approach to the Salesforce Sales Cloud Implementation. Foundation and Core Development phases are in progress, while Integration & Testing and Deployment are planned. This roadmap facilitates strategic planning and resource allocation for future initiatives.
                </p>
              </div>
            </>
          )}

          {/* New Report: Team Capacity */}
          {selectedReport === 'teamCapacity' && (
            <>
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-red-400">
                <h2 className="text-xl font-semibold mb-4">Team Capacity Summary</h2>
                <p className="text-gray-700">
                  This report summarizes the team's capacity, allocated workload, and remaining availability for the upcoming period.
                  Total Capacity: <span className="font-bold">{teamCapacityData.reduce((sum, row) => sum + row.capacity, 0)}</span> person-days/week.
                  Total Allocated: <span className="font-bold">{teamCapacityData.reduce((sum, row) => sum + row.allocated, 0)}</span> person-days/week.
                  Total Remaining: <span className="font-bold">{teamCapacityData.reduce((sum, row) => sum + row.remaining, 0)}</span> person-days/week.
                </p>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-red-400">
                <h2 className="text-xl font-semibold mb-4">Team Capacity Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-red-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('teamMember')}>
                        Team Member {sortConfig.key === 'teamMember' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('role')}>
                        Role {sortConfig.key === 'role' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('capacity')}>
                        Capacity (Person-Days/Week) {sortConfig.key === 'capacity' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('allocated')}>
                        Allocated (Person-Days/Week) {sortConfig.key === 'allocated' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('remaining')}>
                        Remaining (Person-Days/Week) {sortConfig.key === 'remaining' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('availability')}>
                        Availability (%) {sortConfig.key === 'availability' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedTeamCapacityData.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.teamMember}</td>
                        <td className="px-4 py-2 border">{row.role}</td>
                        <td className="px-4 py-2 border">{row.capacity}</td>
                        <td className="px-4 py-2 border">{row.allocated}</td>
                        <td className="px-4 py-2 border">{row.remaining}</td>
                        <td className="px-4 py-2 border">{row.availability}%</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-red-400">
                  <h3 className="font-semibold mb-2">Allocated vs. Remaining Capacity</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.PieChart>
                      <Recharts.Pie
                        data={teamCapacityAvailabilityPieData}
                        dataKey="value"
                        nameKey="name"
                        cx="50%"
                        cy="50%"
                        outerRadius={80}
                        fill="#ef4444"
                        label
                      >
                        {teamCapacityAvailabilityPieData.map((entry, idx) => (
                          <Recharts.Cell key={`cell-${idx}`} fill={['#EF4444', '#FCD34D'][idx % 2]} />
                        ))}
                      </Recharts.Pie>
                      <Recharts.Tooltip />
                      <Recharts.Legend />
                    </Recharts.PieChart>
                  </Recharts.ResponsiveContainer>
                </div>
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-red-400">
                  <h3 className="font-semibold mb-2">Team Member Capacity Overview</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.BarChart data={teamCapacityBarData}>
                      <Recharts.CartesianGrid strokeDasharray="3 3" />
                      <Recharts.XAxis dataKey="teamMember" tick={{ fontSize: 12 }} />
                      <Recharts.YAxis label={{ value: 'Person-Days/Week', angle: -90, position: 'insideLeft', fontSize: 12 }} />
                      <Recharts.Tooltip />
                      <Recharts.Legend />
                      <Recharts.Bar dataKey="capacity" fill="#4F46E5" name="Capacity" />
                      <Recharts.Bar dataKey="allocated" fill="#EF4444" name="Allocated" />
                      <Recharts.Bar dataKey="remaining" fill="#FCD34D" name="Remaining" />
                    </Recharts.BarChart>
                  </Recharts.ResponsiveContainer>
                </div>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-red-400">
                <h2 className="text-xl font-semibold mb-4">Conclusion</h2>
                <p className="text-gray-700">
                  The Team Capacity report indicates that while most team members have some remaining capacity, UX C is fully allocated. This suggests that new tasks might need to be carefully distributed to avoid overburdening certain roles and to ensure project timelines are met.
                </p>
              </div>
            </>
          )}

          {/* New Report: RACI Chart */}
          {selectedReport === 'raciChart' && (
            <>
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-orange-400">
                <h2 className="text-xl font-semibold mb-4">RACI Chart Summary</h2>
                <p className="text-gray-700">
                  The RACI (Responsible, Accountable, Consulted, Informed) chart clarifies roles and responsibilities for various activities within the project. This ensures clear ownership and efficient communication.
                </p>
                <div className="mt-4 p-4 bg-orange-50 rounded-lg border border-orange-200">
                  <h3 className="text-lg font-semibold text-orange-700 mb-2">RACI Definitions:</h3>
                  <ul className="list-disc list-inside text-orange-700 ml-4">
                    <li>**R**esponsible: Performs the task.</li>
                    <li>**A**ccountable: Ensures the task is done and has final authority.</li>
                    <li>**C**onsulted: Provides input based on expertise.</li>
                    <li>**I**nformed: Kept updated on progress.</li>
                  </ul>
                </div>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-orange-400">
                <h2 className="text-xl font-semibold mb-4">RACI Chart Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-orange-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('Activity')}>
                        Activity {sortConfig.key === 'Activity' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      {raciChartData.length > 0 && Object.keys(raciChartData[0]).filter(key => key !== 'Activity').map((role, index) => (
                        <th key={index} className="px-4 py-2 border cursor-pointer" onClick={() => handleSort(role)}>
                          {role} {sortConfig.key === role && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                        </th>
                      ))}
                    </tr>
                  </thead>
                  <tbody>
                    {sortedRaciChartData.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border font-medium">{row.Activity}</td>
                        {Object.keys(row).filter(key => key !== 'Activity').map((role, idx) => (
                          <td key={idx} className="px-4 py-2 border text-center font-bold">
                            {row[role]}
                          </td>
                        ))}
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-orange-400">
                <h2 className="text-xl font-semibold mb-4">RACI Role Distribution by Type</h2>
                <Recharts.ResponsiveContainer width="100%" height={400}>
                  <Recharts.BarChart data={raciRoleCounts} margin={{ top: 20, right: 30, left: 20, bottom: 60 }}>
                    <Recharts.CartesianGrid strokeDasharray="3 3" />
                    <Recharts.XAxis dataKey="role" label={{ value: 'Role', position: 'bottom', offset: 10, fontSize: 12 }} tick={{ fontSize: 12 }} />
                    <Recharts.YAxis label={{ value: 'Count of Responsibilities', angle: -90, position: 'insideLeft', fontSize: 12 }} tick={{ fontSize: 12 }} allowDecimals={false} />
                    <Recharts.Tooltip />
                    <Recharts.Legend />
                    <Recharts.Bar dataKey="R" fill="#F59E0B" name="Responsible" />
                    <Recharts.Bar dataKey="A" fill="#EF4444" name="Accountable" />
                    <Recharts.Bar dataKey="C" fill="#3B82F6" name="Consulted" />
                    <Recharts.Bar dataKey="I" fill="#10B981" name="Informed" />
                  </Recharts.BarChart>
                </Recharts.ResponsiveContainer>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-orange-400">
                <h2 className="text-xl font-semibold mb-4">Conclusion</h2>
                <p className="text-gray-700">
                  The RACI chart clearly defines responsibilities, promoting accountability and efficient workflow. Key roles like Project Manager and Solution Architect are highly involved across various activities, emphasizing the need for robust communication channels.
                </p>
              </div>
            </>
          )}

          {/* New Report: Resource Utilization */}
          {selectedReport === 'resourceUtilization' && (
            <>
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-green-400">
                <h2 className="text-xl font-semibold mb-4">Resource Utilization Summary</h2>
                <p className="text-gray-700">
                  This report provides an overview of how effectively project resources are being utilized, comparing allocated hours to actual hours spent, and calculating utilization percentages.
                  Average Utilization: <span className="font-bold">{(resourceUtilizationData.reduce((sum, row) => sum + row.utilization, 0) / resourceUtilizationData.length).toFixed(2)}%</span>.
                </p>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-green-400">
                <h2 className="text-xl font-semibold mb-4">Resource Utilization Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-green-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('resource')}>
                        Resource {sortConfig.key === 'resource' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('role')}>
                        Role {sortConfig.key === 'role' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('project')}>
                        Project {sortConfig.key === 'project' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('allocatedHours')}>
                        Allocated Hours {sortConfig.key === 'allocatedHours' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('actualHours')}>
                        Actual Hours {sortConfig.key === 'actualHours' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('utilization')}>
                        Utilization (%) {sortConfig.key === 'utilization' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedResourceUtilizationData.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.resource}</td>
                        <td className="px-4 py-2 border">{row.role}</td>
                        <td className="px-4 py-2 border">{row.project}</td>
                        <td className="px-4 py-2 border">{row.allocatedHours}</td>
                        <td className="px-4 py-2 border">{row.actualHours}</td>
                        <td className="px-4 py-2 border">{row.utilization}%</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-green-400">
                  <h3 className="font-semibold mb-2">Resource Utilization Rate</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.BarChart data={resourceUtilizationBarData}>
                      <Recharts.CartesianGrid strokeDasharray="3 3" />
                      <Recharts.XAxis dataKey="resource" tick={{ fontSize: 12 }} />
                      <Recharts.YAxis label={{ value: 'Utilization (%)', angle: -90, position: 'insideLeft', fontSize: 12 }} />
                      <Recharts.Tooltip />
                      <Recharts.Bar dataKey="utilization" fill="#10B981" />
                    </Recharts.BarChart>
                  </Recharts.ResponsiveContainer>
                </div>
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-green-400">
                  <h3 className="font-semibold mb-2">Allocated vs. Actual Hours</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.BarChart data={resourceHoursBarData}>
                      <Recharts.CartesianGrid strokeDasharray="3 3" />
                      <Recharts.XAxis dataKey="resource" tick={{ fontSize: 12 }} />
                      <Recharts.YAxis label={{ value: 'Hours', angle: -90, position: 'insideLeft', fontSize: 12 }} />
                      <Recharts.Tooltip />
                      <Recharts.Legend />
                      <Recharts.Bar dataKey="allocatedHours" fill="#3B82F6" name="Allocated" />
                      <Recharts.Bar dataKey="actualHours" fill="#F59E0B" name="Actual" />
                    </Recharts.BarChart>
                  </Recharts.ResponsiveContainer>
                </div>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-green-400">
                <h2 className="text-xl font-semibold mb-4">Conclusion</h2>
                <p className="text-gray-700">
                  The Resource Utilization report highlights that Jane Smith and Emily Davis have higher than 100% utilization, indicating potential over-allocation, while Mike Johnson is underutilized. This data can inform resource rebalancing to prevent burnout and optimize project efficiency.
                </p>
              </div>
            </>
          )}

          {/* New Report: QM-Defect Tracking Report */}
          {selectedReport === 'defectTrackingReport' && (
            <>
              <div className="bg-white p-6 rounded-lg shadow-md mb-6 border-t-4 border-indigo-400">
                <h2 className="text-xl font-semibold mb-4">QM-Defect Tracking Report Summary</h2>
                <p className="text-gray-700">
                  This report tracks the status of defects identified during the Quality Management process, including their severity, priority, and assignment. There are currently <span className="font-bold">{defectTrackingReportData.length}</span> defects logged.
                </p>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md mb-6 overflow-x-auto border-t-4 border-indigo-400">
                <h2 className="text-xl font-semibold mb-4">Defect Tracking Details</h2>
                <table className="min-w-full table-auto border-collapse">
                  <thead>
                    <tr className="bg-indigo-100">
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('defectId')}>
                        Defect ID {sortConfig.key === 'defectId' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('description')}>
                        Description {sortConfig.key === 'description' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('severity')}>
                        Severity {sortConfig.key === 'severity' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('priority')}>
                        Priority {sortConfig.key === 'priority' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('status')}>
                        Status {sortConfig.key === 'status' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('assignedTo')}>
                        Assigned To {sortConfig.key === 'assignedTo' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('detectedDate')}>
                        Detected Date {sortConfig.key === 'detectedDate' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                      <th className="px-4 py-2 border cursor-pointer" onClick={() => handleSort('resolutionDate')}>
                        Resolution Date {sortConfig.key === 'resolutionDate' && (sortConfig.direction === 'asc' ? '↑' : '↓')}
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {sortedDefectTrackingReportData.map((row, index) => (
                      <tr key={index} className={index % 2 === 0 ? 'bg-gray-50 hover:bg-gray-100' : 'bg-white hover:bg-gray-100'}>
                        <td className="px-4 py-2 border">{row.defectId}</td>
                        <td className="px-4 py-2 border">{row.description}</td>
                        <td className="px-4 py-2 border">{row.severity}</td>
                        <td className="px-4 py-2 border">{row.priority}</td>
                        <td className="px-4 py-2 border">{row.status}</td>
                        <td className="px-4 py-2 border">{row.assignedTo}</td>
                        <td className="px-4 py-2 border">{row.detectedDate}</td>
                        <td className="px-4 py-2 border">{row.resolutionDate || '-'}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>

              <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-indigo-400">
                  <h3 className="font-semibold mb-2">Defects by Status</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.PieChart>
                      <Recharts.Pie
                        data={defectStatusPieData}
                        dataKey="value"
                        nameKey="name"
                        cx="50%"
                        cy="50%"
                        outerRadius={80}
                        fill="#6366f1"
                        label
                      >
                        {defectStatusPieData.map((entry, idx) => (
                          <Recharts.Cell key={`cell-${idx}`} fill={['#F59E0B', '#60A5FA', '#10B981'][idx % 3]} />
                        ))}
                      </Recharts.Pie>
                      <Recharts.Tooltip />
                      <Recharts.Legend />
                    </Recharts.PieChart>
                  </Recharts.ResponsiveContainer>
                </div>
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-indigo-400">
                  <h3 className="font-semibold mb-2">Defects by Severity</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.PieChart>
                      <Recharts.Pie
                        data={defectSeverityPieData}
                        dataKey="value"
                        nameKey="name"
                        cx="50%"
                        cy="50%"
                        outerRadius={80}
                        fill="#818cf8"
                        label
                      >
                        {defectSeverityPieData.map((entry, idx) => (
                          <Recharts.Cell key={`cell-${idx}`} fill={['#EF4444', '#F59E0B', '#10B981'][idx % 3]} />
                        ))}
                      </Recharts.Pie>
                      <Recharts.Tooltip />
                      <Recharts.Legend />
                    </Recharts.PieChart>
                  </Recharts.ResponsiveContainer>
                </div>
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-indigo-400">
                  <h3 className="font-semibold mb-2">Defects by Assigned To</h3>
                  <Recharts.ResponsiveContainer width="100%" height={250}>
                    <Recharts.BarChart data={defectAssignedToBarData}>
                      <Recharts.CartesianGrid strokeDasharray="3 3" />
                      <Recharts.XAxis dataKey="name" tick={{ fontSize: 12 }} />
                      <Recharts.YAxis allowDecimals={false} />
                      <Recharts.Tooltip />
                      <Recharts.Bar dataKey="value" fill="#6366f1" />
                    </Recharts.BarChart>
                  </Recharts.ResponsiveContainer>
                </div>
              </div>

              <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-indigo-400">
                <h2 className="text-xl font-semibold mb-4">Conclusion</h2>
                <p className="text-gray-700">
                  The Defect Tracking Report highlights critical issues like login and data display problems with high severity. Prompt resolution of open high-priority defects, especially those assigned to Dev A and Dev B, is crucial for maintaining project quality and preventing delays.
                </p>
              </div>
            </>
          )}

        </div>
      );
    };

    // Rendering the app
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<ProjectManagementReports />);
  </script>
</body>
</html>
